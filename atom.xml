<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Methol]]></title>
  <link href="https://tuzhihao.com/atom.xml" rel="self"/>
  <link href="https://tuzhihao.com/"/>
  <updated>2024-01-05T16:22:20+08:00</updated>
  <id>https://tuzhihao.com/</id>
  <author>
    <name><![CDATA[]]></name>
    
  </author>
  <generator uri="http://www.coderforart.com/">CoderForArt</generator>

  
  <entry>
    <title type="html"><![CDATA[Synocommunity Package ä½¿ç”¨Cloudflare Workersåå‘ä»£ç†]]></title>
    <link href="https://tuzhihao.com/16704634630585.html"/>
    <updated>2022-12-08T09:37:43+08:00</updated>
    <id>https://tuzhihao.com/16704634630585.html</id>
    <content type="html"><![CDATA[
<h2><a id="synocommunity%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%94%E7%94%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Synocommunity ç¬¬ä¸‰æ–¹åº”ç”¨</h2>
<p><a href="https://synocommunity.com/">Synocommunity</a>æä¾›äº†éå¸¸ä¸°å¯Œå’Œæœ‰ç”¨çš„ç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œå…·ä½“å¯ä»¥å»è¯¥ç½‘ç«™æŸ¥çœ‹ã€‚</p>
<p>åœ¨ä¸­å›½ç”±äºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œè®¿é—®å’Œä¸‹è½½packages.synocommunity.comé‡Œé¢çš„å†…å®¹éå¸¸æ…¢ã€‚å®‰è£…ã€æ›´æ–°åº”ç”¨ä¸€ç›´æ— æ³•æ­£å¸¸è®¿é—®ã€‚æœ€ç®€å•çš„æƒ³æ³•å°±æ˜¯ä½¿ç”¨é•œåƒç½‘ç«™ï¼Œå‘ç°å¹¶æ²¡æœ‰ï¼Œæ‰€ä»¥å°±é€šè¿‡Cloudflare Workersè‡ªå·±æ­å»ºäº†ä¸€ä¸ªã€‚</p>
<p>æ­å»ºè¿‡ç¨‹éå¸¸ç®€å•ï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªä¸“é—¨ç”¨æ¥åå‘ä»£ç†çš„<a href="https://github.com/aD4wn/Workers-Proxy">GitHubé¡¹ç›®</a>ï¼Œç„¶åä¿®æ”¹äº†é…ç½®å°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨æˆ‘æ­å»ºçš„ <code>https://synocommunity-packages.tuzhihao.com</code> ç›´æ¥é…ç½®åœ¨ä½ çš„ç¾¤æ™–ä½¿ç”¨ï¼Œå‚è€ƒä¸‹å›¾ï¼š<br />
<img src="https://f1.465798.xyz/20221208/YToVHb.png" alt="" /></p>
<p>ä¹‹åä½ å°±å¯ä»¥åœ¨ç¤¾ç¾¤é‡Œé¢æ‰¾åˆ°ä¸°å¯Œçš„æ’ä»¶ï¼ŒæŒ‰éœ€ä¸‹è½½ï¼š<br />
<img src="https://f1.465798.xyz/20221208/IzyeNy.png" alt="" /></p>
<h2><a id="%E8%87%AA%E8%A1%8C%E6%90%AD%E5%BB%BA" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>è‡ªè¡Œæ­å»º</h2>
<h3><a id="%E8%84%9A%E6%9C%AC" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>è„šæœ¬</h3>
<p>å½“ç„¶ä½ å¯ä»¥è‡ªå·±æ­å»ºä¸€ä¸ªï¼Œåˆ›å»ºä¸€ä¸ªwokersï¼Œåœ¨çº¿ç¼–è¾‘ï¼Œå¡«å…¥å¦‚ä¸‹è„šæœ¬å†…å®¹ã€‚</p>
<pre><code class="language-plain_text">// copy from https://raw.githubusercontent.com/aD4wn/Workers-Proxy/master/src/index.js

// Website you intended to retrieve for users.
const upstream = 'packages.synocommunity.com'

// Custom pathname for the upstream website.
const upstream_path = '/'

// Website you intended to retrieve for users using mobile devices.
const upstream_mobile = 'packages.synocommunity.com'

// Countries and regions where you wish to suspend your service.
const blocked_region = []

// IP addresses which you wish to block from using your service.
const blocked_ip_address = []

// Whether to use HTTPS protocol for upstream address.
const https = true

// Whether to disable cache.
const disable_cache = true

// Replace texts.
const replace_dict = {
    '$upstream': '$custom_domain'
}

const replace_content_type = [
  'text/html',
  'application/json'
]


addEventListener('fetch', event =&gt; {
    event.respondWith(fetchAndApply(event.request));
})

async function fetchAndApply(request) {

    const region = (request.headers.get('cf-ipcountry') || &quot;&quot;).toUpperCase();
    const ip_address = request.headers.get('cf-connecting-ip') || &quot;&quot;;
    const user_agent = request.headers.get('user-agent') || &quot;&quot;;

    let response = null;
    let url = new URL(request.url);
    let url_hostname = url.hostname;

    if (https == true) {
        url.protocol = 'https:';
    } else {
        url.protocol = 'http:';
    }

    if (await device_status(user_agent)) {
        var upstream_domain = upstream;
    } else {
        var upstream_domain = upstream_mobile;
    }

    url.host = upstream_domain;
    if (url.pathname == '/') {
        url.pathname = upstream_path;
    } else {
        url.pathname = upstream_path + url.pathname;
    }

    if (blocked_region.includes(region)) {
        response = new Response('Access denied: WorkersProxy is not available in your region yet.', {
            status: 403
        });
    } else if (blocked_ip_address.includes(ip_address)) {
        response = new Response('Access denied: Your IP address is blocked by WorkersProxy.', {
            status: 403
        });
    } else {
        let method = request.method;
        let request_headers = request.headers;
        let new_request_headers = new Headers(request_headers);

        new_request_headers.set('Host', upstream_domain);
        new_request_headers.set('Referer', url.protocol + '//' + url_hostname);

        let original_response = await fetch(url.href, {
            method: method,
            headers: new_request_headers
        })

        let original_response_clone = original_response.clone();
        let original_text = null;
        let response_headers = original_response.headers;
        let new_response_headers = new Headers(response_headers);
        let status = original_response.status;
		
		if (disable_cache) {
			new_response_headers.set('Cache-Control', 'no-store');
	    }

        new_response_headers.set('access-control-allow-origin', '*');
        new_response_headers.set('access-control-allow-credentials', true);
        new_response_headers.delete('content-security-policy');
        new_response_headers.delete('content-security-policy-report-only');
        new_response_headers.delete('clear-site-data');
		
        if(new_response_headers.get(&quot;x-pjax-url&quot;)) {
            new_response_headers.set(&quot;x-pjax-url&quot;, response_headers.get(&quot;x-pjax-url&quot;).replace(&quot;//&quot; + upstream_domain, &quot;//&quot; + url_hostname));
        }
		
        const content_type = new_response_headers.get('content-type');
        if (check_replace_response_text(content_type)) {
            console.log('replace');
            original_text = await replace_response_text(original_response_clone, upstream_domain, url_hostname);
        } else {
            original_text = original_response_clone.body
        }
		
        response = new Response(original_text, {
            status,
            headers: new_response_headers
        })
    }
    return response;
}

function check_replace_response_text(content_type) {
  if(content_type == null){
    return false;
  }
  return replace_content_type.some((v) =&gt; content_type.includes(v));
}

async function replace_response_text(response, upstream_domain, host_name) {
    let text = await response.text()

    var i, j;
    for (i in replace_dict) {
        j = replace_dict[i]
        if (i == '$upstream') {
            i = upstream_domain
        } else if (i == '$custom_domain') {
            i = host_name
        }

        if (j == '$upstream') {
            j = upstream_domain
        } else if (j == '$custom_domain') {
            j = host_name
        }

        console.log(i, j);
        let re = new RegExp(i, 'g')
        text = text.replace(re, j);
    }
    return text;
}


async function device_status(user_agent_info) {
    var agents = [&quot;Android&quot;, &quot;iPhone&quot;, &quot;SymbianOS&quot;, &quot;Windows Phone&quot;, &quot;iPad&quot;, &quot;iPod&quot;];
    var flag = true;
    for (var v = 0; v &lt; agents.length; v++) {
        if (user_agent_info.indexOf(agents[v]) &gt; 0) {
            flag = false;
            break;
        }
    }
    return flag;
}
</code></pre>
<h3><a id="%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E6%90%AD%E5%BB%BA%E6%88%90%E5%8A%9F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æ£€æŸ¥æ˜¯å¦æ­å»ºæˆåŠŸ</h3>
<p>è®¿é—®å¦‚ä¸‹åœ°å€(hostæ›¿æ¢ä¸ºä½ è‡ªå·±çš„)ï¼š<br />
<a href="https://synocommunity-packages.tuzhihao.com/?build=42962&amp;language=enu&amp;arch=apollolake">https://synocommunity-packages.tuzhihao.com/?build=42962&amp;language=enu&amp;arch=apollolake</a></p>
<p>æ£€æŸ¥è¿”å›çš„jsoné‡Œé¢çš„linkåœ°å€æ˜¯å¦å·²ç»è¢«æ›¿æ¢ï¼ŒæˆåŠŸæ›¿æ¢å°±ä»£è¡¨æ­å»ºæˆåŠŸï¼Œæ­å–œğŸ‰<br />
<img src="https://f1.465798.xyz/20221208/WHITjf.png" alt="" /></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[telegram bot api proxy]]></title>
    <link href="https://tuzhihao.com/16662544966970.html"/>
    <updated>2022-10-20T16:28:16+08:00</updated>
    <id>https://tuzhihao.com/16662544966970.html</id>
    <content type="html"><![CDATA[
<p>ä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œå¤§é™†æ— æ³•ç›´æ¥è®¿é—®telegram apiï¼Œä½¿ç”¨å„ç§ä»£ç†å·¥å…·éƒ½ä¸å¤Ÿç¨³å®šï¼Œå¯èƒ½ä¸­æ–­ã€‚<br />
å¯ä»¥ä½¿ç”¨cloudflare workersæ¥ä»£ç†telegram bot apiï¼Œåœ¨å›½å†…å¯ä»¥æ­£å¸¸ç»™æœºå™¨äººå‘æ¶ˆæ¯ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">// è¿™é‡Œå¯ä»¥è®¾ç½®botç™½åå•ï¼Œå†™å…¥ä½ çš„bot idå³å¯ï¼Œé˜²æ­¢æ»¥ç”¨
const whitelist = [
  &quot;/bot5245255:&quot;,
  &quot;/bot5065435:&quot;
];
const tg_host = &quot;api.telegram.org&quot;;

addEventListener('fetch', event =&gt; {
    event.respondWith(handleRequest(event.request))
})

function validate(path) {
    for (var i = 0; i &lt; whitelist.length; i++) {
        if (path.startsWith(whitelist[i]) || path.startsWith(&quot;/file&quot; + whitelist[i]))
            return true; 
    }
    return false;
}

async function handleRequest(request) {
    var u = new URL(request.url);
    u.host = tg_host;
    if (!validate(u.pathname))
        return new Response('Unauthorized', {
            status: 403
        });
    var req = new Request(u, {
        method: request.method,
        headers: request.headers,
        body: request.body
    });
    const result = await fetch(req);
    return result;
}
</code></pre>
<p>æœ€åå¼ºçƒˆå»ºè®®ä½¿ç”¨è‡ªå·±çš„åŸŸåï¼Œä¸è¦ç”¨workersçš„åŸŸåï¼Œå›½å†…è¢«å¢™äº†ã€‚</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å°å·è§£å†³æ–¹æ¡ˆ]]></title>
    <link href="https://tuzhihao.com/16662525413137.html"/>
    <updated>2022-10-20T15:55:41+08:00</updated>
    <id>https://tuzhihao.com/16662525413137.html</id>
    <content type="html"><![CDATA[
<p>åƒåœ¾ç”µè¯ã€çŸ­ä¿¡ã€éšç§æ³„æ¼å¼€ç›’ç­‰åŸå› ï¼Œè¿«åˆ‡éœ€è¦æœ‰å°å·æ¥åº”å¯¹è¿™äº›é—®é¢˜ã€‚<br />
é˜¿é‡Œã€è¿è¥å•†éƒ½æœ‰æ¨å‡ºå°å·ï¼Œæˆ‘ç”¨çš„æ˜¯ç”µä¿¡ï¼Œç°åœ¨å®˜æ–¹ä¸ç»™ä½¿ç”¨äº†ã€‚ç§»åŠ¨çš„å°å·è¿˜å¯ä»¥ç”³è¯·ä½¿ç”¨ã€‚</p>
<p>é‚£å°±è¯´ä¸€ä¸‹è¿è¥å•†å°å·å’Œé˜¿é‡Œå°å·çš„ç‰¹ç‚¹ï¼š</p>
<h3><a id="%E8%BF%90%E8%90%A5%E5%95%86%E5%B0%8F%E5%8F%B7" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>è¿è¥å•†å°å·</h3>
<ul>
<li>ç”µä¿¡ä¸ç»™ç”³è¯·ï¼Œç›®å‰åªæœ‰ç§»åŠ¨æœ‰ï¼Œç›´æ¥å°±æŠŠæˆ‘ç»™æ’é™¤äº†</li>
<li>è¿è¥å•†å°å·å—åˆ°å·¥ä¿¡éƒ¨åŒèº«ä»½è¯5ä¸ªå·ç çš„æ•°é‡é™åˆ¶</li>
<li>æ¥æ”¶ç”µè¯ã€çŸ­ä¿¡åŠæ—¶ï¼ŒæœåŠ¡å¯é </li>
<li>è‡ªå·±èº«ä»½çš„å®åä¿¡æ¯(æœ‰ä¸€äº›é“¶è¡Œç­‰æœºæ„ç”¨è¿è¥å•†å·ç ä½œä¸ºå®åè®¤è¯çš„ä¸€ä¸ªå› ç´ )</li>
</ul>
<h3><a id="%E9%98%BF%E9%87%8C%E5%B0%8F%E5%8F%B7" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>é˜¿é‡Œå°å·</h3>
<ul>
<li>éè‡ªå·±å®åä¿¡æ¯</li>
<li>ä¸å—åŒèº«ä»½è¯5å·ç é™åˆ¶</li>
<li>å¯èƒ½éšæ—¶æ¶¨ä»·ï¼Œç°åœ¨36/å¹´ï¼Œè¿˜æ˜¯æ¯”è¿è¥å•†ä¾¿å®œ</li>
<li>æ¥é€šç‡ä¸å¦‚è¿è¥å•†ï¼Œè‡³å°‘æˆ‘å‡ºç°è¿‡ä¸€æ¬¡æ¼æ¥ç”µè¯ï¼Œç›®å‰è¿˜èƒ½æ¥å—</li>
</ul>
<p>å°å·éƒ½æœ‰ä¸€ä¸ªå¯èƒ½å¾ˆå¤§çš„é—®é¢˜å°±æ˜¯è¯´æ²¡å°±æ²¡äº†ï¼Œç‰¹åˆ«æ˜¯é˜¿é‡Œè¿™ç§ã€‚ç”µä¿¡ä¹‹å‰è¿˜æ˜¯ä¸€ç›´å¯ä»¥ç”³è¯·ä½¿ç”¨çš„ï¼Œç°åœ¨åº”è¯¥æ˜¯åªæœåŠ¡è€ç”¨æˆ·ï¼Œæ–°ç”¨æˆ·ä¸è®©ç”¨äº†ã€‚é˜¿é‡Œçš„æ”¾å·ä¹Ÿæ˜¯ä¸€æ®µæ—¶é—´ä¸€æ®µæ—¶é—´çš„ï¼Œæ ¹æœ¬ä¸å¯é ã€‚è€Œä¸”è¿™ç§å„æ–­è¡Œä¸šï¼Œæƒ³æƒ³éƒ½ä¸å¯é ã€‚å·ç ä¸å¯é æ„å‘³ç€ä½ ä¸èƒ½ç”¨ä»–æ¥ç»‘å®šä½ è®¤ä¸ºéå¸¸é‡è¦çš„æœåŠ¡ã€‚</p>
<p>å¯¹æ¯”ä¹Ÿæœ‰äº†ï¼Œé‚£å°±è¯´ä¸€ä¸‹æˆ‘é¢ä¸´çš„é—®é¢˜ï¼Œä»¥åŠæ€ä¹ˆè§£å†³ï¼š</p>
<h3><a id="%E9%97%AE%E9%A2%98%EF%BC%9A" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>é—®é¢˜ï¼š</h3>
<ol>
<li>ä¸æ¥éªšæ‰°ç”µè¯ã€‚</li>
<li>éªŒè¯ç çŸ­ä¿¡æ­£å¸¸æ¥æ”¶ã€‚</li>
<li>æ”¿åºœã€é“¶è¡Œç­‰å•ä½éœ€è¦ç•™æˆ‘å®åè®¤è¯çš„ç”µè¯ã€‚</li>
<li>å¤–å–ã€ç‰©æµç­‰èƒ½æ­£å¸¸è”ç³»åˆ°æˆ‘ã€‚</li>
</ol>
<h3><a id="%E6%88%91%E5%8F%91%E7%8E%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E7%8E%B0%E8%B1%A1" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æˆ‘å‘ç°çš„ä¸€äº›ç°è±¡</h3>
<ol>
<li>é“¶è¡Œç­‰ç±»ä¼¼è¡Œä¸šæ˜¯æœ€å–œæ¬¢æ‰“éªšæ‰°ç”µè¯çš„ï¼Œè€Œä¸”å¾€å¾€ä»–ä»¬æœ‰ä½ çš„çœŸå®ä¿¡æ¯ï¼Œè¿™ä¸ªèº²ä¸æ‰ã€‚</li>
<li>ä¸è¦ç›¸ä¿¡æ”¿åºœéƒ¨é—¨ï¼Œä»–ä»¬ä¹Ÿä¼šæ³„æ¼ä½ çš„ç”µè¯ï¼Œæ¯”å¦‚è½¦ç®¡æ‰€ã€‚</li>
<li>ç”µå•†å¹³å°å¯èƒ½æ³„æ¼ä½ çš„ç”µè¯ï¼Œé¢‘ç¹å‘æ¨å¹¿çŸ­ä¿¡(æ³¨æ„ï¼šä»–ä»¬ä¸€èˆ¬ä¸ä¼šæ‰“ç”µè¯éªšæ‰°ä½ )ã€‚</li>
<li>å¿«é€’æ˜¯ä¸€ä¸ªå¾ˆå®¹æ˜“æ³„æ¼ä½ ä¸ªäººä¿¡æ¯çš„åœºæ™¯ï¼Œè€Œä¸”éƒ½æ˜¯å¾ˆé‡è¦çš„ä¿¡æ¯ï¼ˆç”µè¯ã€å§“åã€é—¨ç‰Œå·ï¼‰</li>
<li>å„APPä½¿ç”¨æ‰‹æœºå·æ³¨å†Œ(æ³•è§„è¦æ±‚)ï¼Œç„¶åå¯¹äºéšç§ä¿¡æ¯çš„ç®¡ç†ä¸€è¨€éš¾å°½ã€‚</li>
</ol>
<p>å¯¹ç…§ä¸Šé¢è¿è¥å•†å°å·å’Œé˜¿é‡Œå°å·éƒ½ä¸èƒ½å¾ˆå®Œç¾çš„è§£å†³é—®é¢˜ï¼Œå› æ­¤æˆ‘æäº†ä¸€ä¸ªè‡ªå·±çš„å°å·æ–¹æ¡ˆã€‚<br />
æˆ‘ç”¨äº†ä¸€ä¸ªæœ‰å®ä½“å¡çš„å‰¯å¡ï¼Œä¹°äº†1ä¸ªé˜¿é‡Œå°å·æ¥è§£å†³æˆ‘çš„é—®é¢˜ã€‚<br />
æˆ‘æŠŠè¿™ä¸¤ä¸ªå¡å½’ç±»ä¸º<strong>èƒ½ç»™æˆ‘æ‰“ç”µè¯çš„å¡</strong>å’Œ<strong>èƒ½ç»™æˆ‘å‘çŸ­ä¿¡çš„å¡</strong>ã€‚<br />
é˜¿é‡Œçš„å°å·ç”¨æ¥åšèƒ½ç»™æˆ‘æ‰“ç”µè¯çš„å¡ï¼Œæˆ‘ç”¨æ¥æ¥å¤–å–å’Œå¿«é€’çš„ç”µè¯ã€‚å¹¶ä¸”1å¹´æˆ–è€…2å¹´æ›´æ–°ä¸€æ¬¡ï¼Œå¤–å–å’Œç‰©æµä¸å†™çœŸå®å§“åï¼Œæœ€å¤šåªç•™åˆ°æ¥¼æ ‹å·ã€‚æ›´æ–°çš„ä»£ä»·ä¹Ÿä¸å¤§ï¼Œå°±æ˜¯å‡ ä¸ªå¸¸ç”¨çš„å¤–å–ã€ç”µå•†å¹³å°ã€‚<br />
è‡ªå»ºçš„å‰¯å¡ç”¨æ¥åšå„ç§APPæ³¨å†Œï¼Œæ”¿åºœã€é“¶è¡Œè¡Œä¸šçš„è”ç³»ç”µè¯ï¼Œæˆ‘ä¸éœ€è¦æ¥ä»–ä»¬çš„ç”µè¯ï¼Œåªéœ€è¦åŠæ—¶æ¥æ”¶åˆ°çŸ­ä¿¡å³å¯ã€‚éªšæ‰°çŸ­ä¿¡æ— æ³•é¿å…ï¼Œä½†æ˜¯è¿˜å¥½çš„æ˜¯ä»–ä¸ä¼šæ‰“æ–­ä½ ï¼Œç”µè¯æ˜¯ä¸€ä¸ªéƒ½æ²¡æœ‰äº†ã€‚è€Œä¸”è¿™ä¸ªç”µè¯æ˜¯æˆ‘è‡ªå·±åœ¨è¿è¥å•†å®åè®¤è¯è¿‡çš„ï¼Œæ‰€ä»¥æœ‰ä¸€äº›è®¤è¯çš„åœºæ™¯ä¹Ÿèƒ½å¾ˆå¥½çš„åšåˆ°ã€‚æœ€é‡è¦çš„è¿™æ˜¯ä¸€ä¸ªå®ä½“çš„å¡ï¼Œè¿è¥å•†æ²¡é“ç†æ— ç¼˜æ— æ•…åœæ­¢æœåŠ¡ã€‚æœ€å·®åé¢æˆ‘ä¹Ÿå¯ä»¥æä¸€ä¸ªä¿å·çš„å¥—é¤ï¼Œä¸€åªå¼€ç€å°±å¥½ã€‚</p>
<h2><a id="%E9%98%BF%E9%87%8C%E5%B0%8F%E5%8F%B7" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>é˜¿é‡Œå°å·</h2>
<p>è¿™é‡Œå°±ä¸å¤šèµ˜è¿°äº†ï¼Œå¯ä»¥ä¹°çš„æ—¶å€™ä¹°ä¸€ä¸ªå°±è¡Œäº†ï¼Œè®¾ç½®ä»€ä¹ˆçš„éƒ½æ¯”è¾ƒç®€å•ã€‚</p>
<h2><a id="%E5%89%AF%E5%8D%A1%E7%9F%AD%E4%BF%A1%E5%B0%8F%E5%8F%B7" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å‰¯å¡çŸ­ä¿¡å°å·</h2>
<p>å‡†å¤‡ä¸€ä¸ªä¸ç”¨çš„Androidæ‰‹æœºï¼Œå®‰è£…2ä¸ªapp<br />
<a href="https://github.com/pppscn/SmsForwarder">https://github.com/pppscn/SmsForwarder</a><br />
<a href="https://github.com/telegram-sms/telegram-sms-china">https://github.com/telegram-sms/telegram-sms-china</a></p>
<p>ç¬¬ä¸€ä¸ªæ˜¯ä¸€ä¸ªçŸ­ä¿¡è½¬å‘çš„è½¯ä»¶ï¼Œå¯ä»¥å¯¹æ¥å„ç§é€šçŸ¥æ¸ é“ï¼Œæˆ‘ç”¨çš„æ˜¯barkï¼Œä½“éªŒéå¸¸å¥½ã€‚<br />
<img src="https://f1.465798.xyz/20221020/z6m8nF.png" alt="" /></p>
<p>ç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªtgçš„è½¯ä»¶ï¼Œæ¯”å•çº¯çš„è½¬å‘çŸ­ä¿¡å¤šäº†æ‰‹æœºçŠ¶æ€çš„ç›‘æ§ï¼Œè¿˜å¯ä»¥ç”¨å®ƒæ¥å‘çŸ­ä¿¡<br />
<img src="https://f1.465798.xyz/20221020/wf8XHi.png" alt="" /><br />
ä½¿ç”¨æ‰‹æœºè‡ªå¸¦çš„4gç½‘ç»œï¼Œä¸è¿æ¥wifiï¼Œå³ä½¿å®¶é‡Œæ–­ç½‘ä¹Ÿä¸ç”¨æ‹…å¿ƒã€‚tgæ— æ³•å›½å†…ç›´æ¥è®¿é—®ï¼Œå¯ä»¥å‚è€ƒ<a href="./16662544966970.html">è¿™ç¯‡æ–‡ç« </a>ï¼Œéƒ¨ç½²ä¸€ä¸ªä»£ç†å³å¯ã€‚</p>
<p>å®‰è£…ä¸¤ä¸ªçš„åŸå› ä¹Ÿå¾ˆç®€å•ï¼Œä¸»å¤‡æ¯”è¾ƒå¯é ï¼Œç¬¬ä¸€ä¸ªé€è¾¾å¿«ï¼Œç¬¬äºŒä¸ªæœ‰æ›´å¤šåŠŸèƒ½ã€‚<br />
ç„¶åå°±æ˜¯æ³¨æ„è®¾ç½®å¼€æœºè‡ªå¯ï¼Œé˜²æ­¢æ¸…åå°ï¼Œå°±å¯ä»¥äº†ã€‚</p>
<h2><a id="%E6%80%BB%E7%BB%93" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æ€»ç»“</h2>
<ol>
<li>å¯ä»¥æ˜¾è‘—è§£å†³éªšæ‰°ç”µè¯çš„é—®é¢˜ï¼Œå› ä¸ºé™¤äº†æˆ‘è‡ªå·±æœ¬èº«çš„ç”µè¯(å¤§éƒ¨åˆ†æ˜¯äº²æˆšã€åŒäº‹ç­‰ç†Ÿäººæ‹¨æ‰“)ï¼Œé˜¿é‡Œå°å·è½¬å‘çš„ç”µè¯ä¹‹å¤–ï¼Œä¸ä¼šæ”¶åˆ°åˆ«çš„åƒåœ¾ç”µè¯äº†ã€‚å¦‚æœå‰¯å¡å®åœ¨æœ‰å¿…è¦ï¼Œå¯ä»¥å¼€ä¸€æ®µæ—¶é—´çš„å‘¼å«è½¬ç§»è§£å†³æ¥ç”µè¯çš„é—®é¢˜ï¼Œä¹‹åå…³é—­ã€‚</li>
<li>ç›®å‰æ¥çœ‹ï¼Œæˆ‘ç”¨äº†å¤§åŠå¹´çš„é˜¿é‡Œå°å·ï¼Œæ²¡æœ‰æ¥åˆ°éªšæ‰°ç”µè¯å’Œåƒåœ¾çŸ­ä¿¡(å¯èƒ½è§†æƒ…å†µå»¶é•¿æ›´æ¢æ—¶é—´)ã€‚æˆ‘ä¸»è¦æ˜¯æŠŠè¿™ä¸ªç”µè¯ç•™åœ¨å¿«é€’å’Œå¤–å–ä¸Šé¢ã€‚</li>
<li>ä¸¤ä¸ªAPPæ¥è½¬å‘çŸ­ä¿¡ï¼Œé€è¾¾ç‡éå¸¸å¯é ã€‚</li>
<li>æ‰‹æœºå› ä¸ºé•¿æ—¶é—´å……ç”µï¼Œæœ‰ç”µæ± é¼“åŒ…é—®é¢˜ã€‚ç›®å‰è§£å†³æ–¹æ¡ˆæ˜¯ç”¨å°ç±³çš„æ™ºèƒ½å¼€å…³ï¼Œå®šæ—¶å¼€å…³ï¼Œå……æ”¾ç”µä¼šå¥½ä¸€äº›ã€‚ä½†æ˜¯è¿˜ä¸å¤ªå®‰å…¨ï¼Œåé¢å‡†å¤‡æ¢æˆä¸“é—¨çš„æœºå™¨ï¼Œç”¨æ¥æ”¶å‘çŸ­ä¿¡ï¼Œå·²ç»æœ‰å¾ˆæˆç†Ÿçš„æ–¹æ¡ˆäº†ï¼Œæ·˜å®æœ‰å–çš„ã€‚ç±»ä¼¼æ ‘è“æ´¾é‚£ç§å°æœºå™¨ã€‚</li>
<li>å„å¤§APPéšç§æ³„æ¼é—®é¢˜æ— æ³•è§£å†³ï¼Œè¿™ä¸ªå®åœ¨æ²¡åŠæ³•ï¼Œç”¨æ‰‹æœºå·æ³¨å†Œæ˜¯å†™åœ¨æ³•è§„çš„ï¼Œåªèƒ½å¯„å¸Œæœ›äºå›½å†…è¶Šæ¥è¶Šä¸¥æ ¼çš„éšç§ä¿æŠ¤æ”¿ç­–ã€‚</li>
<li>çŸ­ä¿¡å·è¿˜æ˜¯ä¼šæ”¶åˆ°è¥é”€çŸ­ä¿¡ï¼Œè¿™ä¸ªæˆ‘ä¸ªäººè¿˜èƒ½å¿å—ï¼Œå®ƒå‘å°±å‘å§ã€‚</li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ä½¿ç”¨backblaze B2 å’Œ Cloudflare Wrokersåšå›¾åºŠ]]></title>
    <link href="https://tuzhihao.com/16661426449923.html"/>
    <updated>2022-10-19T09:24:04+08:00</updated>
    <id>https://tuzhihao.com/16661426449923.html</id>
    <content type="html"><![CDATA[
<p><img src="https://f1.465798.xyz/20221019/Ybv0U0.jpg" alt="" /></p>
<h2><a id="%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8bcakblaze-b2" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä¸ºä»€ä¹ˆä½¿ç”¨bcakblaze B2</h2>
<ul>
<li>å…è´¹ï¼Œæœ‰10Gçš„å…è´¹ç©ºé—´</li>
<li>APIå‹å¥½ï¼Œæ”¯æŒs3 API</li>
<li>å¸¦å®½è”ç›Ÿã€‚ä½¿ç”¨Cloudflareä¸­è½¬è·å–å›¾ç‰‡ä¸è®¡æµé‡è´¹ç”¨</li>
</ul>
<p>æ€ä¹ˆä¼ å›¾ç‰‡å°±ä¸èµ˜è¿°äº†ï¼Œæˆ‘ç”¨çš„æ˜¯uPicï¼Œä½ å¯ä»¥ç”¨ä½ å–œæ¬¢çš„å·¥å…·</p>
<h2><a id="%E4%BD%BF%E7%94%A8bcakblaze-b2" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä½¿ç”¨bcakblaze B2</h2>
<p>å…ˆæ³¨å†Œï¼Œåˆ›å»ºä¸€ä¸ªbucket<br />
<img src="https://f1.465798.xyz/20221019/wIbtCx.png" alt="" /><br />
ç„¶åä¸Šä¼ ä¸€å¼ å›¾(ä¹Ÿå¯ä»¥é…ç½®ä½¿ç”¨ä½ çš„å·¥å…·ä¸Šä¼ ï¼Œæˆ–è€…ç½‘é¡µä¸Šä¼ )ï¼Œç„¶åè®°å½•å¦‚ä¸‹ä¿¡æ¯</p>
<ol>
<li>Bucket Name</li>
<li>Friendly URLé‡Œé¢çš„host</li>
</ol>
<p><img src="https://f1.465798.xyz/20221019/q1ZnJ9.png" alt="" /></p>
<h2><a id="%E4%BD%BF%E7%94%A8cloudflare-workers" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä½¿ç”¨Cloudflare Workers</h2>
<p>ä¸ºä»€ä¹ˆä½¿ç”¨wokersè€Œä¸ç”¨cnameçš„æ–¹å¼æ¥å…¥</p>
<ul>
<li>å»é™¤URLä¸­çš„ /file/<bucket-name> éƒ¨åˆ†</li>
<li>å»é™¤ä¸€äº›ä» Backblaze B2 å“åº”çš„æ— ç”¨è¯·æ±‚å¤´</li>
<li>åŠ ä¸ŠåŸºæœ¬çš„ CORS è¯·æ±‚å¤´ï¼Œä»¥ä¾¿å…è®¸å›¾ç‰‡åµŒå…¥åˆ°ç½‘ç«™ä¸­</li>
<li>ä¸ºå›¾ç‰‡ä¼˜åŒ–ç¼“å­˜ (æµè§ˆå™¨çš„ç¼“å­˜, ä»¥åŠ CDN è¾¹ç•ŒæœåŠ¡å™¨ä¸Šçš„ç¼“å­˜)</li>
</ul>
<p>å…ˆåˆ›å»ºä¸€ä¸ªworkersï¼Œç„¶åå†™å…¥å¦‚ä¸‹è„šæœ¬ï¼Œåªéœ€è¦ä¿®æ”¹2ä¸ªå˜é‡</p>
<ol>
<li>b2Bucket -&gt; ä¸Šè¿°1</li>
<li>b2Domain -&gt; ä¸Šè¿°2</li>
</ol>
<pre><code class="language-js">'use strict';
const b2Domain = 'f004.backblazeb2.com'; // configure this as per instructions above
const b2Bucket = 'bucketName'; // configure this as per instructions above
const b2UrlPath = `/file/${b2Bucket}/`;
addEventListener('fetch', event =&gt; {
	return event.respondWith(fileReq(event));
});

// define the file extensions we wish to add basic access control headers to
const corsFileTypes = ['png', 'jpg', 'gif', 'jpeg', 'webp'];

// backblaze returns some additional headers that are useful for debugging, but unnecessary in production. We can remove these to save some size
const removeHeaders = [
	'x-bz-content-sha1',
	'x-bz-file-id',
	'x-bz-file-name',
	'x-bz-info-src_last_modified_millis',
	'X-Bz-Upload-Timestamp',
	'x-bz-server-side-encryption',
	'x-bz-client-unauthorized-to-read',
	'Expires'
];
const expiration = 31536000; // override browser cache for images - 1 year

// define a function we can re-use to fix headers
const fixHeaders = function(url, status, headers){
	let newHdrs = new Headers(headers);
	// add basic cors headers for images
	if(corsFileTypes.includes(url.pathname.split('.').pop())){
		newHdrs.set('Access-Control-Allow-Origin', '*');
	}
	// override browser cache for files when 200
	if(status === 200){
		newHdrs.set('Cache-Control', &quot;public, max-age=&quot; + expiration);
	}else{
		// only cache other things for 5 minutes
		newHdrs.set('Cache-Control', 'public, max-age=300');
	}
	// set ETag for efficient caching where possible
	const ETag = newHdrs.get('x-bz-content-sha1') || newHdrs.get('x-bz-info-src_last_modified_millis') || newHdrs.get('x-bz-file-id');
	if(ETag){
		newHdrs.set('ETag', ETag);
	}
	// remove unnecessary headers
	removeHeaders.forEach(header =&gt; {
		newHdrs.delete(header);
	});
	return newHdrs;
};

async function fileReq(event){
	const cache = caches.default; // Cloudflare edge caching
	const url = new URL(event.request.url);
	if(!url.pathname.startsWith(b2UrlPath)){ 
		url.pathname = b2UrlPath + url.pathname;
        // console.log(url.pathname);
	}
    url.host = b2Domain;
    // console.log(url);
	let response = await cache.match(url); // try to find match for this request in the edge cache
	if(response){
		// use cache found on Cloudflare edge. Set X-Worker-Cache header for helpful debug
		let newHdrs = fixHeaders(url, response.status, response.headers);
		newHdrs.set('X-Worker-Cache', &quot;true&quot;);
		return new Response(response.body, {
			status: response.status,
			statusText: response.statusText,
			headers: newHdrs
		});
	}
	// no cache, fetch image, apply Cloudflare lossless compression
	response = await fetch(url, {cf: {polish: &quot;lossless&quot;}});
	let newHdrs = fixHeaders(url, response.status, response.headers);

  if(response.status === 200){

    response = new Response(response.body, {
      status: response.status,
      statusText: response.statusText,
      headers: newHdrs
    });
  }else{
    response = new Response('File not found!', { status: 404 })
  }

	event.waitUntil(cache.put(url, response.clone()));
	return response;
}
</code></pre>
<p>è„šæœ¬å‚è€ƒ<br />
<a href="https://blog.meow.page/archives/free-personal-image-hosting-with-backblaze-b2-and-cloudflare-workers/">https://blog.meow.page/archives/free-personal-image-hosting-with-backblaze-b2-and-cloudflare-workers/</a><br />
<a href="https://jross.me/free-personal-image-hosting-with-backblaze-b2-and-cloudflare-workers/">https://jross.me/free-personal-image-hosting-with-backblaze-b2-and-cloudflare-workers/</a></p>
<p>æˆ‘åœ¨è„šæœ¬ä¸Šçš„ä¿®æ”¹æ˜¯æŠŠ<code>b2Domain</code>æ”¹ä¸ºb2çš„hostï¼Œè¿™æ ·è„šæœ¬æ›´å®¹æ˜“ç†è§£ä¸€äº›ã€‚</p>
<p>æœ€åä½ å¯ä»¥ä½¿ç”¨è‡ªå·±çš„åŸŸååšä¸€ä¸ªrouteå°±å¯ä»¥ä½¿ç”¨è‡ªå·±çš„åŸŸåï¼Œcf workersçš„åŸŸååœ¨å›½å†…å¢™çš„æ¯”è¾ƒå‰å®³...</p>
<h2><a id="%E6%8E%A8%E8%8D%90%E4%B8%80%E4%B8%AA%E5%9B%BE%E7%89%87%E7%BD%91%E7%AB%99" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æ¨èä¸€ä¸ªå›¾ç‰‡ç½‘ç«™</h2>
<p><a href="https://unsplash.com">https://unsplash.com</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ä¸‰æ˜Ÿç”µè§†æ¢åŒº]]></title>
    <link href="https://tuzhihao.com/16661412449981.html"/>
    <updated>2022-10-19T09:00:44+08:00</updated>
    <id>https://tuzhihao.com/16661412449981.html</id>
    <content type="html"><![CDATA[
<h2><a id="apple-tv-4k%E6%8C%82%E4%BA%86" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Apple TV 4k æŒ‚äº†</h2>
<p>å®¶é‡Œçš„Apple TV 4kçªç„¶è‡ªå·±å°±æŒ‚æ‰äº†ï¼Œåº”è¯¥ä¸æ˜¯ç¡¬ä»¶çš„é—®é¢˜ï¼Œæ„Ÿè§‰æ˜¯è½¯ä»¶çš„é—®é¢˜ï¼Œä½†æ˜¯èƒŒåä¸€ä¸ªæ¥å£éƒ½æ²¡æœ‰ï¼Œä¹Ÿæ²¡åŠæ³•è‡ªå·±å‡çº§ç³»ç»Ÿã€‚</p>
<p>å‘¨æœ«æ‹¿åˆ°Appleåº—é‡Œï¼Œç»™çš„ç†ç”±å¤§é™†ä¸å–ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¿®ï¼Œåªèƒ½åˆ°é¦™æ¸¯ä¿®ã€‚</p>
<p>è¿™å°±GGäº†...</p>
<p>å› ä¸ºæˆ‘ä¸»è¦æ˜¯çœ‹Youtubeã€Nasè§†é¢‘ã€embyè§†é¢‘ã€netflixï¼Œå®‰å“ç›’å­çš„æ€§èƒ½éƒ½å¤ªå¼±äº†ï¼Œåªèƒ½çœ‹çœ‹æµåª’ä½“ã€‚</p>
<p>è€Œä¸”Apple TVçš„infuseç¥å™¨ï¼ŒYoutubeä»Šå¹´ä¹Ÿæ”¯æŒ4käº†ï¼ŒçœŸæ˜¯å”¯ä¸€é€‰æ‹©ã€‚</p>
<p>å¥½åœ¨å¿«å¼€å‘å¸ƒä¼šäº†ï¼Œç­‰ä¸‹ä¸€ä»£å§ï¼Œæ‰€ä»¥åªèƒ½å…ˆä¸ä¹°äº†ã€‚</p>
<h2><a id="%E4%B8%89%E6%98%9F%E7%94%B5%E8%A7%86%E6%8D%A2%E5%8C%BA" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä¸‰æ˜Ÿç”µè§†æ¢åŒº</h2>
<p>ç„¶åå°±ç ”ç©¶èµ·äº†æˆ‘çš„ç”µè§†ï¼Œå› ä¸ºä¹‹å‰æ˜¯æœ‰çˆ±å¥‡è‰ºã€è…¾è®¯é‚£äº›è§†é¢‘çš„ã€‚æ‰€ä»¥çœ‹çœ‹èƒ½ä¸èƒ½å…ˆè£…ä¸€ä¸ªyoutubeçœ‹çœ‹ã€‚</p>
<p>ç³»ç»Ÿæ˜¯ä¸‰æ˜Ÿè‡ªå·±çš„tizenç³»ç»Ÿï¼Œåº”ç”¨åªèƒ½å»è‡ªå¸¦çš„åº”ç”¨å•†åº—ä¸‹è½½ã€‚é‚£è¿™æ²¡åŠæ³•äº†ï¼Œåªèƒ½æ¢åŒºã€‚</p>
<p>æœç„¶ï¼Œå°±æœåˆ°äº†2ç¯‡æ–‡ç« ï¼Œå·²ç»è¯´çš„å¾ˆè¯¦ç»†äº†ï¼Œæˆ‘è¿™é‡Œåªæ˜¯å¯¹æˆ‘è‡ªå·±çš„ç”µè§†æ“ä½œåšä¸€ä¸ªå¤‡ä»½ã€‚</p>
<p><a href="https://sspai.com/post/59549">https://sspai.com/post/59549</a></p>
<p><a href="https://joveng.myds.me:8888/tv-unlock/">https://joveng.myds.me:8888/tv-unlock/</a></p>
<h3><a id="%E6%AD%A5%E9%AA%A4" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æ­¥éª¤</h3>
<ol>
<li>å¸¦æœ‰çº¢å¤–çš„æ™ºèƒ½æ‰‹æœºè¯·ä¸‹è½½ã€ŒIR Service Remoteã€çš„APPã€‚</li>
</ol>
<p><a href="https://f1.465798.xyz/file/Service_Remote_Control_1.2.apk">Service_Remote_Control_1.2.apk</a></p>
<p>åœ¨ç”µè§†å¤„äºäº®å±çš„çŠ¶æ€ä¸‹ï¼Œæ‰“å¼€ã€ŒIR Service remoteã€ä¾æ¬¡æŒ‰ä¸‹ã€ŒS1ã€-ã€ŒS2ã€å³å¯è¿›å…¥å·¥ç¨‹æ¨¡å¼èœå•</p>
<p><img src="https://f1.465798.xyz/img/20240105/1lFb5v.jpg" alt="image-20210418212716653" /></p>
<ol start="2">
<li>
<p>ä½¿ç”¨ç”µè§†é¥æ§å™¨ã€Œæ–¹å‘é”®ã€å°†å…‰æ ‡ç§»åŠ¨åˆ°ã€ŒOptionã€é€‰é¡¹ï¼ŒæŒ‰ä¸€ä¸‹ã€Œç¡®å®šé”®ã€è¿›å…¥ï¼Œç„¶åä½¿ç”¨æ‰‹æœºæ‹ç…§å½“å‰ç”»é¢ã€‚è¿›å…¥ä¹‹åå¯ä»¥çœ‹åˆ°ã€ŒLocal Setã€é€‰é¡¹æ˜¯ã€ŒCHI_DTVã€ï¼Œæ„å‘³å½“å‰ç³»ç»Ÿæ˜¯å›½åŒºã€‚</p>
<p>å°†å…‰æ ‡ç§»åŠ¨åˆ°ã€ŒLocal Setã€é€‰é¡¹å¹¶æŒ‰ä¸‹ã€Œç¡®å®šé”®ã€è¿›å…¥ï¼Œåœ¨å¼¹å‡ºçš„ã€ŒLocal Set Listã€åˆ—è¡¨é‡Œç§»åˆ°ä½ æƒ³è¦åˆ‡æ¢çš„åœ°åŒºä»£ç ï¼Œç¾åŒºé€‰æ‹©ã€ŒAD_AU2ã€ï¼Œæ¸¯åŒºé€‰æ‹©ã€ŒHKG_DTVã€ï¼Œä¹‹åæŒ‰ä¸‹é¥æ§å™¨ã€Œç¡®å®šé”®ã€åä¼šè‡ªåŠ¨è¿”å›ã€‚</p>
<p><img src="https://f1.465798.xyz/img/20240105/Tv1PoF.jpg" alt="image-20210418212855744" /></p>
</li>
<li>
<p>å†æ¬¡è¿›å…¥åˆ°ã€ŒMRT Optionã€é€‰é¡¹ï¼Œè¿›å…¥ã€ŒLanguage Setã€é€‰é¡¹å¹¶ç¡®ä¿æ­¤å¤„å‚æ•°æ˜¾ç¤ºä¸ºã€ŒChinaã€ï¼Œè¿”å›å¹¶è¿›å…¥ã€ŒRegionã€ç¡®ä¿æ­¤å¤„å‚æ•°æ˜¾ç¤ºä¸ºã€Œasia_dtvã€ï¼Œå…¶ä½™çš„å‚æ•°æŒ‰ç…§ä¹‹å‰æ‹çš„ç…§ç‰‡ä¾æ¬¡å¤åŸå³å¯ã€‚ã€ŒProduction Optionã€å’Œã€ŒEngineer Optionã€åŒç†ã€‚</p>
</li>
<li>
<p>é‡å¯ç”µè§†ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨é¥æ§å™¨ä¾æ¬¡é€‰æ‹©ã€Œè®¾ç½®ã€-ã€Œæ”¯æŒã€-ã€Œè‡ªè¯Šæ–­ã€-ã€Œé‡ç½® Smart Hubã€ï¼Œè¾“å…¥ PIN ç ã€Œ0000ã€åç³»ç»Ÿæ¡Œé¢ä¼šé‡å¯ã€‚</p>
<p><img src="https://f1.465798.xyz/img/20240105/tvutHc.jpg" alt="image-20210418213026402" /></p>
</li>
<li>
<p>é‡å¯ä¹‹åå…‰æ ‡ç§»åŠ¨åˆ°ã€Œappsã€ä¼šå¼¹å‡ºã€ŒåŒæ„æ¡æ¬¾ã€é¡µé¢ï¼Œæ³¨æ„å³ä¾¿å½“å‰ç”µè§†çš„ç³»ç»Ÿè¯­è¨€ä¸ºç®€ä½“ä¸­æ–‡ï¼Œä½†æ­¤é¡µé¢åº”ä¸ºè‹±æ–‡ç•Œé¢ã€‚ä½¿ç”¨ç”µè§†åŸå‚é¥æ§å™¨åœ¨ã€ŒåŒæ„æ¡æ¬¾ã€é¡µé¢ä»¥æ­¤æŒ‰ä¸‹ã€Œé™éŸ³ã€-ã€ŒéŸ³é‡ +ã€-ã€Œé¢‘é“ +ã€-ã€Œé™éŸ³ã€æŒ‰é”®ï¼Œç”µè§†ä¼šå¼¹å‡ºã€ŒInternet æœåŠ¡ä½ç½®è®¾ç½®ã€é€‰é¡¹ã€‚é€‰æ‹©é¦™æ¸¯ã€‚</p>
<p><img src="https://f1.465798.xyz/img/20240105/HvxepK.jpg" alt="image-20210418213101873" /></p>
</li>
<li>
<p>æœ€ååŒæ„åè®®ï¼Œå®‰è£…appå°±è¡Œäº†ï¼</p>
<p><img src="https://f1.465798.xyz/img/20240105/q6Z7Mw.jpg" alt="image-20210418213749906" /></p>
</li>
</ol>
<h2><a id="%E5%A4%87%E4%BB%BD%E5%8F%82%E6%95%B0%E6%88%AA%E5%9B%BE" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å¤‡ä»½å‚æ•°æˆªå›¾</h2>
<h3><a id="%E4%BF%AE%E6%94%B9%E5%89%8D%E5%9B%BD%E5%8C%BA" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä¿®æ”¹å‰(å›½åŒº)</h3>
<p><img src="https://f1.465798.xyz/img/20240105/FwYhOw.jpg" alt="image-20210418213525967" /></p>
<p><img src="https://f1.465798.xyz/img/20240105/JObp1k.jpg" alt="image-20210418213536752" /></p>
<p><img src="https://f1.465798.xyz/img/20240105/YBIIEx.jpg" alt="image-20210418213549420" /></p>
<h3><a id="%E4%BF%AE%E6%94%B9%E5%90%8E%E6%B8%AF%E5%8C%BA" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä¿®æ”¹å(æ¸¯åŒº)</h3>
<p><img src="https://f1.465798.xyz/img/20240105/9AhrmZ.jpg" alt="image-20210418213446438" /></p>
<p><img src="https://f1.465798.xyz/img/20240105/hrmdIQ.jpg" alt="image-20210418213500655" /></p>
<p><img src="https://f1.465798.xyz/img/20240105/ONd3Bx.jpg" alt="image-20210418213510547" /></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CountDownLatchå’ŒCyclicBarrier]]></title>
    <link href="https://tuzhihao.com/16661412451143.html"/>
    <updated>2022-10-19T09:00:45+08:00</updated>
    <id>https://tuzhihao.com/16661412451143.html</id>
    <content type="html"><![CDATA[
<h2><a id="%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä½¿ç”¨åœºæ™¯</h2>
<h3><a id="%E5%9C%BA%E6%99%AF%E4%B8%80" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>åœºæ™¯ä¸€</h3>
<p>å·¥ä½œä¸­éœ€è¦åœ¨webæœåŠ¡å¯¹å¤–ä¹‹å‰ï¼Œspringçš„beanåˆå§‹åŒ–çš„æ—¶å€™åŠ è½½æ•°æ®åˆ°ç¼“å­˜ä¸­ã€‚<br />
ä½†æ˜¯ç”±äºæ•°æ®é‡è¿‡å¤§ï¼Œéœ€è¦å¤šçº¿ç¨‹åŠ è½½ã€‚è¦æ±‚æ‰€æœ‰çš„ç¼“å­˜åŠ è½½æˆåŠŸä¹‹åï¼Œè¿™ä¸ªbeanæ‰åˆå§‹åŒ–æˆåŠŸï¼Œç¨‹åºç»§ç»­å¾€ä¸‹èµ°ã€‚</p>
<h3><a id="%E5%9C%BA%E6%99%AF%E4%BA%8C" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>åœºæ™¯äºŒ</h3>
<p>å•†åŠ¡åˆä½œçš„éœ€æ±‚ï¼Œéœ€è¦æ˜¾ç¤ºçš„æ•°æ®æ¥è‡ªåˆä½œæ–¹å’Œæˆ‘ä»¬è‡ªå·±çš„æ•°æ®åº“ä¸­ã€‚<br />
ä¹‹å‰æ˜¯åªæ˜¾ç¤ºæˆ‘ä»¬æ•°æ®åº“ç‚¹æ•°æ®ï¼Œç°åœ¨åˆä½œæ–¹æä¾›äº†ä¸€ä¸ªæ¥å£è®©æˆ‘å®æ—¶è°ƒç”¨å¯¹æ–¹çš„æ¥å£ï¼Œå¹¶æŠŠä¸¤éƒ¨åˆ†çš„æ•°æ®åˆå¹¶åè¿”å›ç»™å‰ç«¯ã€‚<br />
ä½†æ˜¯ç”±äºåˆä½œæ–¹çš„æ¥å£ä¸æ˜¯ç‰¹åˆ«ç¨³å®šï¼Œè€Œä¸”ä¹Ÿä¸èƒ½ä¿è¯é«˜å¯ç”¨ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘åŒæ—¶ä»æˆ‘ä»¬å’Œåˆä½œæ–¹å–æ•°æ®ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå¦‚æœéƒ½è¿”å›äº†æ•°æ®å°±åˆå¹¶ç»™å‰ç«¯ï¼Œå¦‚æœå¯¹æ–¹æœªèƒ½è¿”å›æ•°æ®ï¼Œè¿˜æ˜¯æœ‰æˆ‘ä»¬è‡ªå·±çš„æ•°æ®èƒ½æ˜¾ç¤ºç»™ç”¨æˆ·çš„ã€‚</p>
<h2><a id="countdownlatch%E5%92%8Ccyclicbarrier" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CountDownLatchå’ŒCyclicBarrier</h2>
<p>ç»¼åˆä¸Šè¿°ä¸¤ä¸ªåœºæ™¯ï¼Œæˆ‘çœ‹äº†CountDownLatchå’ŒCyclicBarrierï¼Œçœ‹è¯´æ˜è§‰å¾—æ¯”è¾ƒé€‚åˆæˆ‘çš„ä½¿ç”¨ã€‚</p>
<h3><a id="countdownlatch" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CountDownLatch</h3>
<pre><code class="language-plain_text">package countdownlatchtest;

import com.google.common.collect.Maps;

import java.util.concurrent.ConcurrentMap;
import java.util.concurrent.CountDownLatch;

public class CountDownLatchService {

    private CountDownLatch countDownLatch = new CountDownLatch(4);

    /**
     * ç”¨æ¥å­˜å‚¨æ‰€æœ‰çº¿ç¨‹çš„è¿è¡Œç»“æœ
     */
    private ConcurrentMap&lt;String, String&gt; resultMap = Maps.newConcurrentMap();



    public CountDownLatch getCountDownLatch() {
        return countDownLatch;
    }

    public ConcurrentMap&lt;String, String&gt; getResultMap() {
        return resultMap;
    }
}
</code></pre>
<pre><code class="language-plain_text">package countdownlatchtest;

import org.apache.commons.lang3.RandomUtils;

import java.util.concurrent.ConcurrentMap;
import java.util.concurrent.CountDownLatch;

public class Worker implements Runnable {

    private ConcurrentMap&lt;String, String&gt; map;
    private CountDownLatch countDownLatch;

    public Worker(ConcurrentMap&lt;String, String&gt; map, CountDownLatch countDownLatch) {
        this.map = map;
        this.countDownLatch = countDownLatch;
    }

    @Override
    public void run() {

        // è¿™é‡Œå†™ä»£ç åšæŸäº›äº‹
        System.out.println(Thread.currentThread().getName() + &quot;\tå¼€å§‹äº†...&quot;);
        final int sleep = RandomUtils.nextInt(5, 20);
        try {
            Thread.sleep(sleep * 1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        // æ·»åŠ ç»“æœåˆ°mapä¸­
        map.putIfAbsent(Thread.currentThread().getName(), String.valueOf(sleep));

        // å‘Šè¯‰ countDownLatch ï¼Œå½“å‰çº¿ç¨‹å®Œæˆäº†
        System.out.println(Thread.currentThread().getName() + &quot;\tç»“æŸäº†...&quot;);
        countDownLatch.countDown();
    }
}

</code></pre>
<pre><code class="language-plain_text">package countdownlatchtest;

import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class Main {

    public static void main(String[] args) {
        final ExecutorService executorService = Executors.newFixedThreadPool(6);
        for (int i = 0; i &lt; 3; i++) {
            // æ¨¡æ‹Ÿå¤šæ¬¡æ‰§è¡Œä»»åŠ¡
            doTask(executorService);
        }
    }

    private static void doTask(ExecutorService executorService) {
        CountDownLatchService countDownLatchService = new CountDownLatchService();
        for (int i = 0; i &lt; 4; i++) {
            Worker worker = new Worker(countDownLatchService.getResultMap(), countDownLatchService.getCountDownLatch());
            executorService.submit(worker);
        }
        try {
            // é˜»å¡åœ¨è¿™é‡Œï¼Œç­‰å¾…å…¶ä»–çº¿ç¨‹æ‰§è¡Œå®Œæˆ
            countDownLatchService.getCountDownLatch().await();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println(&quot;æ‰€æœ‰çº¿ç¨‹æ‰§è¡ŒæˆåŠŸ&quot;);
        System.out.println(&quot;æ‰“å°ç»“æœå¦‚ä¸‹ï¼š\n&quot; + countDownLatchService.getResultMap());
    }

}
</code></pre>
<h3><a id="cyclicbarrier" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CyclicBarrier</h3>
<pre><code class="language-plain_text">package cyclicbarriertest;

import com.google.common.collect.Maps;

import java.util.concurrent.ConcurrentMap;
import java.util.concurrent.CyclicBarrier;

public class CyclicBarrierService implements Runnable {

    /**
     * è¡¨ç¤ºå½“æœ‰4ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨ç¬¬äºŒä¸ªå‚æ•° barrierAction çš„start()æ–¹æ³•
     *
     * æ‰€ä»¥æœ¬ç±»å®ç° Runnable æ¥å£ï¼Œä¼ å…¥this
     */
    private CyclicBarrier cyclicBarrier = new CyclicBarrier(4, this);

    /**
     * ç”¨æ¥å­˜å‚¨æ‰€æœ‰çº¿ç¨‹çš„è¿è¡Œç»“æœ
     */
    private ConcurrentMap&lt;String, String&gt; resultMap = Maps.newConcurrentMap();

    @Override
    public void run() {
        System.out.println(&quot;æ‰€æœ‰çº¿ç¨‹æ‰§è¡ŒæˆåŠŸ&quot;);
        System.out.println(&quot;æ‰“å°ç»“æœå¦‚ä¸‹ï¼š\n&quot; + resultMap);
    }

    public ConcurrentMap&lt;String, String&gt; getResultMap() {
        return resultMap;
    }

    public CyclicBarrier getCyclicBarrier() {
        return cyclicBarrier;
    }
}
</code></pre>
<pre><code class="language-plain_text">package cyclicbarriertest;

import org.apache.commons.lang3.RandomUtils;

import java.util.concurrent.BrokenBarrierException;
import java.util.concurrent.ConcurrentMap;
import java.util.concurrent.CyclicBarrier;

public class Worker implements Runnable {

    private ConcurrentMap&lt;String, String&gt; map;
    private CyclicBarrier cyclicBarrier;

    public Worker(ConcurrentMap&lt;String, String&gt; map, CyclicBarrier cyclicBarrier) {
        this.map = map;
        this.cyclicBarrier = cyclicBarrier;
    }

    @Override
    public void run() {

        // è¿™é‡Œå†™ä»£ç åšæŸäº›äº‹
        System.out.println(Thread.currentThread().getName() + &quot;\tå¼€å§‹äº†...&quot;);
        final int sleep = RandomUtils.nextInt(5, 20);
        try {
            Thread.sleep(sleep * 1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        // æ·»åŠ ç»“æœåˆ°mapä¸­
        map.putIfAbsent(Thread.currentThread().getName(), String.valueOf(sleep));

        try {
            // å‘Šè¯‰ cyclicBarrier ï¼Œå½“å‰çº¿ç¨‹å®Œæˆäº†
            System.out.println(Thread.currentThread().getName() + &quot;\tç»“æŸäº†...&quot;);
            cyclicBarrier.await();
        } catch (InterruptedException | BrokenBarrierException e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<pre><code class="language-plain_text">package cyclicbarriertest;

import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class Main {

    public static void main(String[] args) {
        final ExecutorService executorService = Executors.newFixedThreadPool(6);
        for (int j = 0; j &lt; 3; j++) {
            // æ¨¡æ‹Ÿå¤šæ¬¡ä»»åŠ¡æ‰§è¡Œ
            doTask(executorService);
        }
    }

    private static void doTask(ExecutorService executorService) {
        CyclicBarrierService cyclicBarrierService = new CyclicBarrierService();
        for (int i = 0; i &lt; 4; i++) {
            Worker worker = new Worker(cyclicBarrierService.getResultMap(), cyclicBarrierService.getCyclicBarrier());
            executorService.submit(worker);
        }
    }
}

</code></pre>
<h2><a id="%E6%80%BB%E7%BB%93" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æ€»ç»“</h2>
<p>å†™äº†ä¸Šé¢ä¸¤ä¸ªä¾‹å­ï¼Œåé¢å‘ç°åœºæ™¯ä¸€é€‚åˆç”¨<code>CountDownLatch</code>ï¼Œåœºæ™¯äºŒé€‚åˆç”¨<code>CyclicBarrier</code>ã€‚åœºæ™¯ä¸€æˆ‘ä»¬åŸºæœ¬ä¸Šä¸å­˜åœ¨æœ‰ä»»åŠ¡ä¸èƒ½æ‰§è¡Œå®Œçš„æƒ…å†µï¼ŒåŸºæœ¬ä¸Šåšåˆ°è®¡æ•°å™¨ä¸å½’0ï¼Œå³ä½¿æœåŠ¡å¯åŠ¨äº†ä¹Ÿæ²¡åŠæ³•æ­£å¸¸ä½¿ç”¨ï¼Œåœºæ™¯äºŒå¾ˆå¤šæƒ…å†µéƒ½æ˜¯ä»»åŠ¡ä¸èƒ½æ­£å¸¸çš„æ‰§è¡Œå®Œæˆã€‚</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[è®¾è®¡æ¨¡å¼ ç®€å•å·¥å‚ å·¥å‚æ–¹æ³• æŠ½è±¡å·¥å‚]]></title>
    <link href="https://tuzhihao.com/16661412449263.html"/>
    <updated>2022-10-19T09:00:44+08:00</updated>
    <id>https://tuzhihao.com/16661412449263.html</id>
    <content type="html"><![CDATA[
<p>é’ˆå¯¹å®ä½“userï¼Œå¸Œæœ›å†™ä¸€ç³»åˆ—çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿå®ç°æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥ç­‰åŠŸèƒ½ã€‚</p>
<pre><code class="language-java">    public static void main(String[] args) {
        User u = new User();
        u.setName(&quot;methol&quot;);

        add(u);
        edit(u);
    }
    
    public static void add(User user){
        System.out.println(&quot;save userã€&quot; + user.getName() + &quot;ã€‘ to db&quot;);
    }
    
    public static void edit(User user){
        System.out.println(&quot;edit userã€&quot; + user.getName() + &quot;ã€‘, and save to db&quot;);
    }
</code></pre>
<p>ä¸Šé¢çš„æ–¹æ³•è™½ç„¶åŸºæœ¬ä¸Šå®ç°äº†åŠŸèƒ½ï¼Œä½†æ˜¯ä¸åˆ©äºç¨‹åºä»¥åçš„æ‰©å±•å’Œå¤ç”¨ï¼Œä»£ç ä¹Ÿä¸å®¹æ˜“ç»´æŠ¤ã€‚<br />
é€šè¿‡å°è£…ã€ç»§æ‰¿ã€å¤šæ€æŠŠç¨‹åºçš„è€¦åˆåº¦é™ä½ï¼Œä½¿ç”¨è®¾è®¡æ¨¡å¼å¯ä»¥ä½¿å¾—ç¨‹åºæ›´åŠ çµæ´»ï¼ŒåæœŸå®¹æ˜“ä¿®æ”¹ï¼Œä¹Ÿæ›´åŠ æ˜“äºå¤ç”¨ã€‚<br />
æœ‰äº†å¦‚ä¸‹çš„ä»£ç ï¼š</p>
<pre><code class="language-plain_text">package mode.factory.simple;

import mode.factory.bean.User;

public interface Operation {

    void operate(User user);

}
</code></pre>
<pre><code class="language-plain_text">
package mode.factory.simple;

import mode.factory.bean.User;

public class AddOperate implements Operation {

    @Override
    public void operate(User user) {
        System.out.println(&quot;save userã€&quot; + user.getName() + &quot;ã€‘ to db&quot;);
    }
}
</code></pre>
<pre><code class="language-plain_text">package mode.factory.simple;

import mode.factory.bean.User;

public class EditOperate implements Operation {

    @Override
    public void operate(User user) {
        System.out.println(&quot;edit userã€&quot; + user.getName() + &quot;ã€‘, and save to db&quot;);
    }
}
</code></pre>
<pre><code class="language-plain_text">    public static void main(String[] args) {
        User u = new User();
        u.setName(&quot;methol&quot;);

        // ä¸åŒçš„æ“ä½œéœ€è¦newä¸åŒçš„ç±»æ“ä½œ
        Operation addOperate = new AddOperate();
        addOperate.operate(u);
        Operation editOperate = new EditOperate();
        editOperate.operate(u);
    }
</code></pre>
<p>ä¸Šè¿°ä»£ç å·²ç»ç»è¿‡å°è£…ï¼Œå¹¶ä¸”ä¹Ÿé€‚åˆä¹‹åçš„ä»£ç æ‰©å±•ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœåæœŸæƒ³é€šè¿‡ä¸åŒçš„å‚æ•°ï¼ˆäº‹å…ˆä¸çŸ¥é“æ˜¯è¦æ‰§è¡Œeditè¿˜æ˜¯addï¼‰ï¼Œé‚£ä¹ˆå°±è¦é€šè¿‡æ¡ä»¶åˆ¤æ–­è¦åšçš„æ“ä½œï¼Œè¿™æ—¶ç®€å•å·¥å‚æ¨¡å¼å¯èƒ½å°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„é€‰æ‹©ã€‚</p>
<h2><a id="%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ç®€å•å·¥å‚æ¨¡å¼ä¸å·¥å‚æ¨¡å¼</h2>
<pre><code class="language-plain_text">package mode.factory.simple;

public class OperateFactory {
    public static Operation findOperation(String operation) {
        switch (operation) {
            case &quot;add&quot;:
                return new AddOperate();
            case &quot;edit&quot;:
                return new EditOperate();
            default:
                return null;
        }
    }
}
</code></pre>
<p>é€šè¿‡å·¥å‚ç±»æ¥å¸®æˆ‘ä»¬newä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯ç›´æ¥åœ¨ä»£ç ä¸­éœ€è¦çš„åœ°æ–¹newä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨åŒä¸€ä¸ªåœ°æ–¹ç®¡ç†ï¼ŒåæœŸçš„ä»£ç ç»´æŠ¤å’Œæ‰©å±•æ€§éƒ½å¼ºäº†å¾ˆå¤šã€‚<br />
æˆ–è€…è¿™æ—¶æƒ³å¢åŠ ä¸€ä¸ªdeleteæ–¹æ³•ï¼Œåªéœ€è¦ç»§æ‰¿<code>Operation</code>ç±»ï¼Œå†™ä¸€ä¸ªæ–¹æ³•ï¼Œç„¶ååœ¨<code>OperateFactory</code>å¢åŠ ä¸€ä¸ªcaseå³å¯ã€‚<br />
<strong>ç®€å•å·¥å‚æ¨¡å¼</strong>ï¼Œå°±æ˜¯ä¸€ä¸ªç®€å•çš„åˆ›å»ºäº§å“(<code>Operation</code>)çš„å·¥å…·ï¼Œå¯ä»¥æ˜¯<code>AddOperate</code>ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯<code>EditOperate</code>ç±»ï¼Œç”šè‡³ä»–ä»¬ä¹‹é—´æ²¡æœ‰ä»»ä½•å…³ç³»ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ã€‚<br />
<strong>å·¥å‚æ¨¡å¼</strong>ï¼Œä»–ä¹Ÿæ˜¯ä¸€ä¸ªç®€å•çš„åˆ›å»ºäº§å“(<code>Operation</code>)çš„å·¥å…·ï¼Œä½†æ˜¯ä»–æœ‰ä¸€ä¸ªåŒºåˆ«æ˜¯æ‰€æœ‰çš„äº§å“(<code>AddOperate</code>ï¼Œ<code>EditOperate</code>)éƒ½æ˜¯ç»§æ‰¿(å®ç°)<code>Operation</code>è¿™ä¸ªçˆ¶ç±»çš„ï¼Œçˆ¶ç±»ä¸­æœ‰æŠ½è±¡çš„æ–¹æ³•ï¼Œä¹‹åéƒ½æ˜¯è°ƒç”¨åŒä¸€ä¸ªæ–¹æ³•æ¥åšæ“ä½œã€‚<br />
ä½¿ç”¨ä¸­ï¼Œå¾ˆå°‘ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼ï¼Œå¤§å¤šéƒ½æ˜¯å·¥å‚æ¨¡å¼ï¼Œè°ˆåˆ°å·¥å‚æ¨¡å¼ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯æŒ‡çš„å·¥å‚æ¨¡å¼ã€‚</p>
<pre><code class="language-java">    public static void main(String[] args) {
        User u = new User();
        u.setName(&quot;methol&quot;);

        // ä¸åŒçš„æ“ä½œéœ€è¦newä¸åŒçš„ç±»æ“ä½œ
        Operation addOperate = new AddOperate();
        addOperate.operate(u);
        Operation editOperate = new EditOperate();
        editOperate.operate(u);

        // ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å·¥å‚ï¼Œè®©å·¥å‚æ¥å¸®æˆ‘ä»¬é€‰æ‹©
        OperateFactory.findOperation(&quot;add&quot;).operate(u);
        OperateFactory.findOperation(&quot;edit&quot;).operate(u);
    }
</code></pre>
<h2><a id="%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å·¥å‚æ–¹æ³•</h2>
<p>å¯¹<code>Operation</code>åšäº†ä¸€äº›å°çš„ä¿®æ”¹ï¼Œå¢åŠ äº†ä¸€ä¸ªæ–¹æ³•</p>
<pre><code class="language-plain_text">public interface Operation {

    void operate(User user);

    Operation createDefault(String operationType);
}
</code></pre>
<pre><code class="language-plain_text">public class AddOperate implements Operation {

    @Override
    public void operate(User user) {
        System.out.println(&quot;save userã€&quot; + user.getName() + &quot;ã€‘ to db&quot;);
    }

    @Override
    public Operation createDefault(String operationType) {
        return OperateFactory.findOperation(operationType);
    }
}
</code></pre>
<pre><code class="language-plain_text">public class EditOperate implements Operation {

    @Override
    public void operate(User user) {
        System.out.println(&quot;edit userã€&quot; + user.getName() + &quot;ã€‘, and save to db&quot;);
    }

    @Override
    public Operation createDefault(String operationType) {
        return OperateFactory.findOperation(operationType);
    }
}
</code></pre>
<p>å·¥å‚æ–¹æ³•ä¸»è¦ç³»æ˜¯ä¸¤ä¸ªå…ƒç´ ï¼Œäº§å“(<code>Operation</code>)å’Œåˆ›å»ºè€…(<code>OperateFactory</code>)ã€‚<br />
è€Œå·¥å‚æ–¹æ³•å°±æ˜¯ä¸€ä¸ªåˆ›å»ºè€…è¿™ä¸ªç±»çš„ä¸€ä¸ªæ–¹æ³•è€Œå·²ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯ç”¨æ¥å°è£…äº§å“çš„åˆ›å»ºã€‚<br />
å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«æ˜¯ï¼Œå·¥å‚æ¨¡å¼çš„æœ€å¤§ä¼˜ç‚¹åœ¨äºå·¥å‚ç±»ä¸­åŒ…å«äº†é€»è¾‘åˆ¤æ–­ï¼Œæ ¹æ®(å®¢æˆ·ç«¯)ä¼ å…¥çš„å‚æ•°åŠ¨æ€å®ä¾‹åŒ–ç›¸å…³çš„ç±»ï¼Œé‚£ä¹ˆå¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œä»–æ˜¯ä¸éœ€è¦å…³å¿ƒäº§å“(<code>Operation</code>)çš„ï¼Œä»–åªéœ€è¦å…³å¿ƒä¼ å…¥çš„å‚æ•°ã€‚è€Œå·¥å‚æ¨¡å¼è¿™æ—¶æŠŠè¿™ä¸€åŠ¨ä½œå»¶åï¼Œæ¥å£å®šä¹‰äº†ä¸€ä¸ªç”¨æ¥åˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸ªç±»ï¼Œå·¥å‚æ–¹æ³•ä½¿ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹å»¶è¿Ÿåˆ°å…¶å­ç±»ã€‚</p>
<h2><a id="%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æŠ½è±¡å·¥å‚</h2>
<p>æŠ½è±¡å·¥å‚ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¯¹å·¥å‚è¿›è¡ŒæŠ½è±¡ã€‚<br />
å·¥å‚æ–¹æ³•å’Œå·¥å‚æ¨¡å¼éƒ½æ˜¯å¯¹äº§å“æŠ½è±¡å°è£…ï¼Œé€šè¿‡ä¸€ä¸ªå·¥å‚ï¼Œç”Ÿäº§å¤šç§äº§å“ã€‚<br />
æŠ½è±¡å·¥å‚å°±æ˜¯é€šè¿‡ä¸åŒçš„å·¥å‚ç”Ÿäº§ä¸åŒçš„äº§å“ã€‚<br />
è¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œ<code>OperateFactory</code>åˆ›å»ºäº†æ–°å¢å’Œä¿®æ”¹ä¸¤ç§æ“ä½œ(äº§å“)ï¼Œæ­¤æ—¶æœ‰ä¸€ä¸ªæ–°çš„éœ€æ±‚æ¥äº†ï¼Œä¹‹å‰ç”¨çš„æ•°æ®åº“ä½¿mysqlï¼Œç°åœ¨æƒ³æ”¹æˆoracleï¼Œæ­¤æ—¶å°±å¯¹OperateFactoryè¿›è¡ŒæŠ½è±¡ã€‚</p>
<pre><code class="language-plain_text">package mode.factory.abstracs;

import mode.factory.bean.User;
import mode.factory.simple.Operation;

public interface Factory {

    void add(User user);

    void edit(User user);

    Operation createDefault(String operationType);
}
</code></pre>
<p>æ¥å£ç”³æ˜äº†ï¼Œä¸ç®¡æ˜¯ç”³æ˜å·¥å‚ï¼Œéƒ½éœ€è¦æœ‰addå’Œeditè¿™ä¸¤ç§äº§å“çš„ç”Ÿäº§ã€‚ä¸åŒçš„æ¥å£åªéœ€è¦å®ç°è¿™ä¸ªæ¥å£ï¼Œåšè‡ªå·±çš„æ“ä½œå³å¯ã€‚åŒæ—¶ä¸åŒçš„å·¥å‚è¿˜å¯ä»¥å®ç°è‡ªå·±ç‹¬æœ‰çš„äº§å“çš„ç”Ÿäº§ã€‚</p>
<pre><code class="language-plain_text">package mode.factory.abstracs;

import mode.factory.bean.User;
import mode.factory.simple.Operation;

public class MysqlOperateFactory implements Factory {
    @Override
    public void add(User user) {
        createDefault(&quot;add&quot;).operate(user);
    }

    @Override
    public void edit(User user) {
        createDefault(&quot;edit&quot;).operate(user);
    }

    @Override
    public Operation createDefault(String operationType) {
        return new MysqlOperate().findOperation(operationType);
    }
}
</code></pre>
<pre><code class="language-plain_text">package mode.factory.abstracs;

import mode.factory.bean.User;
import mode.factory.simple.Operation;

public class OracleOperateFactory implements Factory {
    @Override
    public void add(User user) {
        createDefault(&quot;add&quot;).operate(user);
    }

    @Override
    public void edit(User user) {
        createDefault(&quot;edit&quot;).operate(user);
    }

    @Override
    public Operation createDefault(String operationType) {
        return new OracleOperate().findOperation(operationType);
    }
}
</code></pre>
<p>è¿™é‡Œä¹Ÿç”¨äº†å·¥å‚æ–¹æ³•çš„æ€æƒ³ï¼ŒæŠ½è±¡å·¥å‚çš„æ¨¡å¼å®ç°äº†å·¥å‚çº¿çš„æ‰©å±•ã€‚</p>
<h2><a id="%E5%B0%8F%E7%BB%93" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>å°ç»“</h2>
<ol>
<li>å·¥å‚æ¨¡å¼å°±æ˜¯ä¸€ä¸ªç±»ï¼Œå®ƒç”¨æ¥æ ¹æ®å®¢æˆ·ç«¯(å‚æ•°)å…·ä½“çš„å®ä¾‹åŒ–æŸä¸ªå¯¹è±¡ã€‚</li>
<li>å·¥å‚æ–¹æ³•ä¹Ÿæ˜¯å®ä¾‹åŒ–å¯¹è±¡ï¼Œä½†æ˜¯ä»–æŠŠè¿™ä¸ªè¿‡ç¨‹å»¶è¿Ÿåˆ°äº†å­ç±»ï¼Œç”±å­ç±»å†³å®šå…·ä½“å®ä¾‹åŒ–å“ªä¸ªå¯¹è±¡ã€‚</li>
<li>æŠ½è±¡å·¥å‚æ˜¯å¯¹å·¥å‚çš„æ‰©å±•ã€‚ä»–æ˜¯åœ¨å·¥å‚æ–¹æ³•çš„ä¸Šé¢åšçš„è¿›ä¸€æ­¥çš„æŠ½è±¡ã€‚</li>
<li>å·¥å‚æ¨¡å¼æ˜¯ç”¨æ¥ç”Ÿäº§äº§å“çš„ï¼Œä¸èƒ½å¢åŠ äº§å“ï¼›å·¥å‚æ–¹æ³•æ˜¯ç”¨æ¥ç”Ÿäº§äº§å“ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å¢åŠ äº§å“ï¼ˆå®ç°æ¥å£ï¼Œå¢åŠ äº§å“ï¼‰ï¼›æŠ½è±¡å·¥å‚ç”¨æ¥å¢åŠ å·¥å‚çš„ï¼Œä»–ä¸èƒ½å¢åŠ äº§å“ã€‚</li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å¸ƒéš†è¿‡æ»¤å™¨å’ŒGuavaçš„å®ç°]]></title>
    <link href="https://tuzhihao.com/16661412449464.html"/>
    <updated>2022-10-19T09:00:44+08:00</updated>
    <id>https://tuzhihao.com/16661412449464.html</id>
    <content type="html"><![CDATA[
<h2><a id="%E4%BB%8B%E7%BB%8D" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä»‹ç»</h2>
<p>å¸ƒéš†è¿‡æ»¤å™¨å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„äºŒè¿›åˆ¶å‘é‡å’Œä¸€ç³»åˆ—çš„éšæœºæ˜ å°„å‡½æ•°ã€‚å¯ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚</p>
<h2><a id="%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä½¿ç”¨åœºæ™¯</h2>
<ul>
<li>ä¸€ä¸ªå¤§å‹çš„çˆ¬è™«ç½‘ç»œä¸­ï¼Œåˆ¤æ–­æŸä¸€ä¸ªç½‘å€æ˜¯å¦è¢«è®¿é—®è¿‡ã€‚</li>
<li>å¤§æ•°æ®é‡çš„è¯è¯­(å¥å­)å»é‡ã€‚</li>
</ul>
<h2><a id="%E5%8E%9F%E7%90%86" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>åŸç†</h2>
<p>å¸ƒéš†è¿‡æ»¤å™¨çš„æ ¸å¿ƒå®ç°æ˜¯ä¸€ä¸ªè¶…å¤§çš„ä½æ•°ç»„å’Œå‡ ä¸ªå“ˆå¸Œå‡½æ•°ã€‚å‡è®¾æ•°ç»„çš„é•¿åº¦ä¸ºmï¼Œå“ˆå¸Œå‡½æ•°çš„ä¸ªæ•°ä¸ºkã€‚<br />
<img src="https://f1.465798.xyz/img/20240105/fNIho5.jpg" alt="å¸ƒéš†è¿‡æ»¤å™¨åŸç†å›¾" /><br />
å¦‚ä¸Šå›¾ï¼šå‡è®¾é›†åˆé‡Œé¢æœ‰x,y,zï¼Œé€šè¿‡hashå‡½æ•°è®¡ç®—åçš„ç»“æœä¸ºa,b,cï¼Œé‚£ä¹ˆw[a],w[b],w[c]éƒ½ä¼šè¡¨æ ‡è®°ä¸º1ã€‚å‡è®¾ç°åœ¨æœ‰3ä¸ªhashå‡½æ•°ï¼Œå¦‚å›¾3ä¸ªä¸åŒé¢œè‰²çš„çº¿ï¼Œåˆ†åˆ«è®¡ç®—å‡ºä¸åŒçš„ç»“æœï¼Œå¹¶æ ‡è®°ä¸º1ã€‚å½“åˆ¤æ–­æŸä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆçš„æ—¶å€™ï¼Œå°±é€šè¿‡åˆ¤æ–­è¿™ä¸‰ä¸ªhashçš„ç»“æœï¼Œå¦‚æœéƒ½æ˜¯1ï¼Œè¯´æ˜è¯¥å…ƒç´ åœ¨è¿™ä¸ªé›†åˆä¸­ã€‚å¦‚æœæœ‰ä¸€ä¸ªä¸º0ï¼Œè¯´æ˜è¯¥å…ƒç´ ä¸åœ¨æ­¤é›†åˆä¸­ã€‚å› æ­¤ï¼Œè¿™ä¹Ÿæ˜¯å­˜åœ¨è¯¯åˆ¤çš„åŸå› ã€‚<br />
æ€»çš„æ¥è¯´ï¼Œbloom filteræ˜¯ä»¥æä½çš„çš„é”™è¯¯å»æ¢å–ç©ºé—´å’Œæ—¶é—´ã€‚</p>
<h2><a id="%E4%BC%98%E7%82%B9" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä¼˜ç‚¹</h2>
<ul>
<li>æœ‰å¾ˆå¥½çš„ç©ºé—´å’Œæ—¶é—´æ•ˆç‡ã€‚</li>
<li>ä¸å­˜åœ¨æ¼æŠ¥çš„é—®é¢˜ï¼Œå°±æ˜¯è¯´å¦‚æœå…ƒç´ å­˜åœ¨çš„è¯ï¼Œé‚£å¿…å®šçš„åˆ°çš„æ˜¯æ­£ç¡®çš„ç»“æœï¼Œè¿™ä¸ªå…ƒç´ ç¡®å®æ˜¯å­˜åœ¨çš„ã€‚</li>
<li>ä¸æ˜¯ç”¨åŸå§‹æ•°æ®è¿›è¡Œçš„åˆ¤æ–­ï¼Œå¯¹äºæŸäº›æ•æ„Ÿçš„æ•°æ®ä¹Ÿæ˜¯å¯ä»¥é€‚ç”¨çš„ã€‚</li>
</ul>
<h2><a id="%E7%BC%BA%E7%82%B9" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ç¼ºç‚¹</h2>
<ul>
<li>è¯¯æŠ¥ç‡éšç€å…ƒç´ çš„å¢åŠ ï¼Œè¯¯æŠ¥ï¼ˆå°†ä¸å­˜åœ¨çš„å…ƒç´ åˆ¤å®šä¸ºå­˜åœ¨ï¼‰ä¹Ÿä¼šè¶Šä¸¥é‡ã€‚</li>
<li>ä¸èƒ½åˆ é™¤å·²æ·»åŠ çš„å…ƒç´ ï¼Œå› ä¸ºæ˜¯å¤šä¸ªhashå‡½æ•°çš„ç»“æœå€¼å¯¹åº”ä¸€ä¸ªå…ƒç´ ã€‚</li>
</ul>
<h2><a id="%E8%87%AA%E5%B7%B1%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84bloomfilter" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>è‡ªå·±å®ç°ä¸€ä¸ªç®€å•çš„BloomFilter</h2>
<pre><code class="language-java">public interface BloomFilter&lt;T&gt; {

    /**
     * æ·»åŠ ä¸€ä¸ªæ•°æ®åˆ°bloomfilterå†…
     *
     * @param element è¦æ·»åŠ çš„å…ƒç´ 
     */
    void add(T element);

    /**
     * åˆ¤æ–­è¯¥è¿‡æ»¤å™¨å†…æ˜¯å¦å­˜åœ¨å…ƒç´ 
     *
     * @param element è¢«åˆ¤æ–­çš„å…ƒç´ 
     * @return æ˜¯å¦å­˜åœ¨
     */
    boolean contains(T element);
}


import java.util.BitSet;

public class SimpleBloomFilter implements BloomFilter&lt;String&gt; {


    /**
     * å­˜å‚¨çš„bitå®¹é‡
     */
    private static final int DEFAULT_SIZE = Integer.MAX_VALUE;

    /**
     * å­˜å‚¨æ ‡å¿—ä½çš„bits
     */
    private BitSet bits = new BitSet(DEFAULT_SIZE);

    /**
     * ä¸åŒhashå‡½æ•°çš„ç§å­
     */
    private static final int[] seeds = new int[]{113, 213, 3111, 397, 611, 532};
    /**
     * hashå‡½æ•°çš„æ•°ç»„
     */
    private SimpleHash[] hashFunction = new SimpleHash[seeds.length];

    public SimpleBloomFilter() {
        // é»˜è®¤åˆå§‹åŒ– hashFunction
        for (int i = 0; i &lt; seeds.length; i++) {
            hashFunction[i] = new SimpleHash(DEFAULT_SIZE, seeds[i]);
        }
    }

    @Override
    public void add(String element) {
        for (SimpleHash function : hashFunction) {
            final int hash = function.hash(element);
            bits.set(hash, true);
        }
    }

    @Override
    public boolean contains(String element) {
        for (SimpleHash function : hashFunction) {
            if (!bits.get(function.hash(element))) {
                return false;
            }
        }
        return true;
    }

    private static class SimpleHash {

        private int cap;
        private int seed;

        private SimpleHash(int cap, int seed) {
            this.cap = cap;
            this.seed = seed;
        }

        /**
         * ç®€å•çš„å†™ä¸€ä¸ªhashç®—æ³•
         */
        public int hash(String value) {
            int result = 0;
            int len = value.length();
            for (int i = 0; i &lt; len; i++) {
                result = seed * result + value.charAt(i) + value.hashCode();
            }
            // æŠŠå€¼çš„èŒƒå›´æ§åˆ¶åœ¨capå†…
            return (cap - 1) &amp; result;
        }
    }
}

</code></pre>
<h2><a id="guava%E4%B8%AD%E7%9A%84bloomfilter" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Guavaä¸­çš„BloomFilter</h2>
<p>ä¸»è¦æ˜¯ä¸¤ä¸ªç±»ï¼Œ<code>com.google.common.hash.BloomFilter</code>å’Œ<code>com.google.common.hash.BloomFilterStrategies</code>ã€‚</p>
<pre><code class="language-java">  /** The bit set of the BloomFilter (not necessarily power of 2!) */
  private final BitArray bits;

  /** Number of hashes per element */
  private final int numHashFunctions;

  /** The funnel to translate Ts to bytes */
  private final Funnel&lt;? super T&gt; funnel;

  /**
   * The strategy we employ to map an element T to {@code numHashFunctions} bit indexes.
   */
  private final Strategy strategy;
</code></pre>
<p>å››ä¸ªæˆå‘˜å˜é‡ï¼Œ<code>BitArray</code>æ˜¯<code>BloomFilterStrategies</code>ä¸­çš„é™æ€å†…éƒ¨ç±»ã€‚ä½œç”¨å’Œä¸Šé¢çš„<code>BitSet</code>ç±»ä¼¼ã€‚æœ‰åŸºæœ¬çš„getå’Œsetæ–¹æ³•ï¼ŒåŒæ—¶æä¾›äº†ä¸€äº›å…¶ä»–å¸¸ç”¨çš„æ–¹æ³•ã€‚</p>
<pre><code class="language-java">  static final class BitArray {
    final long[] data;
    long bitCount;

    BitArray(long bits) {
      this(new long[Ints.checkedCast(LongMath.divide(bits, 64, RoundingMode.CEILING))]);
    }

    // Used by serialization
    BitArray(long[] data) {
      checkArgument(data.length &gt; 0, &quot;data length is zero!&quot;);
      this.data = data;
      long bitCount = 0;
      for (long value : data) {
        bitCount += Long.bitCount(value);
      }
      this.bitCount = bitCount;
    }

    /** Returns true if the bit changed value. */
    boolean set(long index) {
      if (!get(index)) {
        data[(int) (index &gt;&gt;&gt; 6)] |= (1L &lt;&lt; index);
        bitCount++;
        return true;
      }
      return false;
    }

    boolean get(long index) {
      return (data[(int) (index &gt;&gt;&gt; 6)] &amp; (1L &lt;&lt; index)) != 0;
    }

    /** Number of bits */
    long bitSize() {
      return (long) data.length * Long.SIZE;
    }

    /** Number of set bits (1s) */
    long bitCount() {
      return bitCount;
    }

    BitArray copy() {
      return new BitArray(data.clone());
    }

    /** Combines the two BitArrays using bitwise OR. */
    void putAll(BitArray array) {
      checkArgument(
          data.length == array.data.length,
          &quot;BitArrays must be of equal length (%s != %s)&quot;,
          data.length,
          array.data.length);
      bitCount = 0;
      for (int i = 0; i &lt; data.length; i++) {
        data[i] |= array.data[i];
        bitCount += Long.bitCount(data[i]);
      }
    }

    @Override
    public boolean equals(@Nullable Object o) {
      if (o instanceof BitArray) {
        BitArray bitArray = (BitArray) o;
        return Arrays.equals(data, bitArray.data);
      }
      return false;
    }

    @Override
    public int hashCode() {
      return Arrays.hashCode(data);
    }
  }
</code></pre>
<p><code>numHashFunctions</code>æ˜¯è¡¨ç¤ºä¸€ä¸ªå…ƒç´ å¯¹åº”äº†å‡ ä¸ªhashå‡½æ•°ï¼Œå’Œä¸Šé¢<code>hashFunction.length</code>æ˜¯ä¸€ä¸ªæ„æ€ã€‚<br />
<code>strategy</code>æ˜¯æŠŠå…ƒç´ æ˜ å°„ä¸ºhashå€¼çš„ç­–ç•¥ï¼Œç±»ä¼¼ä¸Šé¢çš„<code>hashFunction</code>ã€‚<code>BloomFilter</code>å®šäº†äº†<code>Strategy</code>æ¥å£ã€‚<code>put</code>æ–¹æ³•æŠŠ<code>numHashFunctions</code>ä¸ªé€šè¿‡è®¡ç®—åçš„å€¼æ”¾å…¥bitArrayä¸­ã€‚<code>mightContain</code>è¿”å›è¯¥è¿‡æ»¤å™¨æ˜¯å¦å¯èƒ½å«æœ‰å…ƒç´ Tã€‚<code>ordinal</code>å°±æ˜¯æšä¸¾ç±»çš„<code>ordinal()</code>ã€‚</p>
<pre><code class="language-java">  interface Strategy extends java.io.Serializable {

    /**
     * Sets {@code numHashFunctions} bits of the given bit array, by hashing a user element.
     *
     * &lt;p&gt;Returns whether any bits changed as a result of this operation.
     */
    &lt;T&gt; boolean put(T object, Funnel&lt;? super T&gt; funnel, int numHashFunctions, BitArray bits);

    /**
     * Queries {@code numHashFunctions} bits of the given bit array, by hashing a user element;
     * returns {@code true} if and only if all selected bits are set.
     */
    &lt;T&gt; boolean mightContain(
        T object, Funnel&lt;? super T&gt; funnel, int numHashFunctions, BitArray bits);

    /**
     * Identifier used to encode this strategy, when marshalled as part of a BloomFilter. Only
     * values in the [-128, 127] range are valid for the compact serial form. Non-negative values
     * are reserved for enums defined in BloomFilterStrategies; negative values are reserved for any
     * custom, stateful strategy we may define (e.g. any kind of strategy that would depend on user
     * input).
     */
    int ordinal();
  }
</code></pre>
<p>å¹¶åœ¨<code>BloomFilterStrategies</code>ä¸­ç»™å‡ºäº†ä¸¤ä¸ªå®ç°çš„æšä¸¾ã€‚</p>
<pre><code class="language-java">  MURMUR128_MITZ_32() {
    @Override
    public &lt;T&gt; boolean put(
        T object, Funnel&lt;? super T&gt; funnel, int numHashFunctions, BitArray bits) {
      long bitSize = bits.bitSize();
      long hash64 = Hashing.murmur3_128().hashObject(object, funnel).asLong();
      int hash1 = (int) hash64;
      int hash2 = (int) (hash64 &gt;&gt;&gt; 32);

      boolean bitsChanged = false;
      for (int i = 1; i &lt;= numHashFunctions; i++) {
        int combinedHash = hash1 + (i * hash2);
        // Flip all the bits if it's negative (guaranteed positive number)
        if (combinedHash &lt; 0) {
          combinedHash = ~combinedHash;
        }
        bitsChanged |= bits.set(combinedHash % bitSize);
      }
      return bitsChanged;
    }

    @Override
    public &lt;T&gt; boolean mightContain(
        T object, Funnel&lt;? super T&gt; funnel, int numHashFunctions, BitArray bits) {
      long bitSize = bits.bitSize();
      long hash64 = Hashing.murmur3_128().hashObject(object, funnel).asLong();
      int hash1 = (int) hash64;
      int hash2 = (int) (hash64 &gt;&gt;&gt; 32);

      for (int i = 1; i &lt;= numHashFunctions; i++) {
        int combinedHash = hash1 + (i * hash2);
        // Flip all the bits if it's negative (guaranteed positive number)
        if (combinedHash &lt; 0) {
          combinedHash = ~combinedHash;
        }
        if (!bits.get(combinedHash % bitSize)) {
          return false;
        }
      }
      return true;
    }
  },
  /**
   * This strategy uses all 128 bits of {@link Hashing#murmur3_128} when hashing. It looks different
   * than the implementation in MURMUR128_MITZ_32 because we're avoiding the multiplication in the
   * loop and doing a (much simpler) += hash2. We're also changing the index to a positive number by
   * AND'ing with Long.MAX_VALUE instead of flipping the bits.
   */
  MURMUR128_MITZ_64() {
    @Override
    public &lt;T&gt; boolean put(
        T object, Funnel&lt;? super T&gt; funnel, int numHashFunctions, BitArray bits) {
      long bitSize = bits.bitSize();
      byte[] bytes = Hashing.murmur3_128().hashObject(object, funnel).getBytesInternal();
      long hash1 = lowerEight(bytes);
      long hash2 = upperEight(bytes);

      boolean bitsChanged = false;
      long combinedHash = hash1;
      for (int i = 0; i &lt; numHashFunctions; i++) {
        // Make the combined hash positive and indexable
        bitsChanged |= bits.set((combinedHash &amp; Long.MAX_VALUE) % bitSize);
        combinedHash += hash2;
      }
      return bitsChanged;
    }

    @Override
    public &lt;T&gt; boolean mightContain(
        T object, Funnel&lt;? super T&gt; funnel, int numHashFunctions, BitArray bits) {
      long bitSize = bits.bitSize();
      byte[] bytes = Hashing.murmur3_128().hashObject(object, funnel).getBytesInternal();
      long hash1 = lowerEight(bytes);
      long hash2 = upperEight(bytes);

      long combinedHash = hash1;
      for (int i = 0; i &lt; numHashFunctions; i++) {
        // Make the combined hash positive and indexable
        if (!bits.get((combinedHash &amp; Long.MAX_VALUE) % bitSize)) {
          return false;
        }
        combinedHash += hash2;
      }
      return true;
    }

    private /* static */ long lowerEight(byte[] bytes) {
      return Longs.fromBytes(
          bytes[7], bytes[6], bytes[5], bytes[4], bytes[3], bytes[2], bytes[1], bytes[0]);
    }

    private /* static */ long upperEight(byte[] bytes) {
      return Longs.fromBytes(
          bytes[15], bytes[14], bytes[13], bytes[12], bytes[11], bytes[10], bytes[9], bytes[8]);
    }
  };
</code></pre>
<p>Guavaå°±æ˜¯é€‰å–äº†è¿™ä¸¤ä¸ªhashç®—æ³•ä¸­çš„ä¸€ä¸ªï¼Œåˆ›å»ºä¸€ä¸ªBloomFilterå¯ä»¥æŒ‡å®šå…¶ä¸­çš„ä¸€ä¸ªç®—æ³•ï¼Œå…·ä½“çš„ç®—æ³•é€»è¾‘å¯ä»¥å‚çœ‹<a href="http://www.cyhone.com/2017/02/07/Introduce-to-BloomFilter/">è§£è¯»BloomFilterç®—æ³•</a><br />
ä½¿ç”¨å®ä¾‹ï¼š</p>
<pre><code class="language-java">    private static void bloomFilter() throws Exception {
        final BloomFilter&lt;String&gt; dealIdBloomFilter = BloomFilter.create(new Funnel&lt;String&gt;() {
            @Override
            public void funnel(String from, PrimitiveSink into) {
                into.putString(from, Charsets.UTF_8);
            }
        }, 3000000, 0.0000001d);
        BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(new File(&quot;C:\\Users\\Methol\\Desktop\\jiaokao-word.txt&quot;)), &quot;utf-8&quot;));
        String line;
        int i = 0;
        StringBuilder sb = new StringBuilder();
        while ((line = br.readLine()) != null) {
            if (!dealIdBloomFilter.mightContain(line)) {
                dealIdBloomFilter.put(line);
                sb.append(line).append(&quot;\n&quot;);
                i++;
            }
            if (i % 1000 == 0) {
                FileUtils.write(new File(&quot;C:\\Users\\Methol\\Desktop\\bloomFilterDistinct.txt&quot;),
                        sb.toString(), Charsets.UTF_8, true);
                sb = new StringBuilder();
            }
        }
        FileUtils.write(new File(&quot;C:\\Users\\Methol\\Desktop\\bloomFilterDistinct.txt&quot;),
                sb.toString(), Charsets.UTF_8, true);
    }
</code></pre>
<h2><a id="%E6%89%A9%E5%B1%95" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æ‰©å±•</h2>
<p>åŒæ ·å¯¹å¤§æ•°æ®é‡çš„å†…å®¹è¿›è¡Œæ»¤é‡ï¼Œå½“æ—¶è¿˜æƒ³åˆ°äº†ç”¨sparkï¼Œä¸è¿‡è¿™ä¸ªçœŸçš„æœ‰ç‚¹å¤§ç‚®æ‰“å°é¸Ÿçš„æ„Ÿè§‰ï¼Œç”¨èµ·æ¥ä»£ç æ˜¯éå¸¸ç®€å•ï¼Œä½†æ˜¯å•å•å°±æ»¤é‡è¿™ä»¶äº‹æ¥è¯´ï¼Œè¿˜æ˜¯BloomFilterå¥½ç”¨ã€‚<br />
800wè¡Œçš„å¥å­ï¼Œæ»¤é‡åæœ‰200wï¼Œsparkçš„ç”¨æ—¶æ¯”BloomFilterç•¥å¤šã€‚<br />
è´´ä¸€æ®µsparkçš„ä»£ç ï¼š</p>
<pre><code class="language-java">    private static void spark() {
        System.setProperty(&quot;hadoop.home.dir&quot;, &quot;D:\\server\\hadoop-common-2.2.0\\&quot;);
        SparkConf conf = new SparkConf().setAppName(&quot;Text String Distinct&quot;).setMaster(&quot;local&quot;).set(&quot;spark.executor.memory&quot;, &quot;1g&quot;);
        JavaSparkContext sc = new JavaSparkContext(conf);
        JavaRDD&lt;String&gt; textFile = sc.textFile(&quot;C:\\Users\\Methol\\Desktop\\jiaokao-word.txt&quot;);
        final JavaRDD&lt;String&gt; distinct = textFile.distinct();
        final long count = distinct.count();
        System.out.println(count);
        distinct.coalesce(1).saveAsTextFile(&quot;C:\\Users\\Methol\\Desktop\\distinct&quot;);
    }
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MySql ç©ºé—´ç´¢å¼•]]></title>
    <link href="https://tuzhihao.com/16661412450896.html"/>
    <updated>2022-10-19T09:00:45+08:00</updated>
    <id>https://tuzhihao.com/16661412450896.html</id>
    <content type="html"><![CDATA[
<p>Mysql5.7ç‰ˆæœ¬ä¹‹åæ”¯æŒç©ºé—´ç´¢å¼•ï¼Œè¯•ç”¨ä¸‹å®ç°ç¦»æˆ‘æœ€è¿‘çš„åŠŸèƒ½ã€‚<br />
æ„Ÿè§‰æŸ¥è¯¢é€Ÿåº¦è¿˜æ˜¯æ²¡æœ‰eså¿«ï¼Œä½†æ˜¯å°æ•°æ®é‡ä¹Ÿæ˜¯ä¸€ä¸ªå¯ç”¨çš„åŠæ³•ã€‚</p>
<pre><code class="language-sql">create database geo_test default charset = utf8mb4;
use geo_test;

create table t_dealer
(
    id bigint not null auto_increment primary key,
    dealer_name varchar(255) not null,
    city_code varchar(45) null,
    phone varchar(32) null,
    lat decimal(10,7) null,
    lon decimal(10,7) null,
    create_time datetime null
)default charset = utf8mb4;
create index idx_name on t_dealer (dealer_name);
comment on table t_dealer is 'åŸºæœ¬ä¿¡æ¯è¡¨';
comment on column dealer_name is '@cname:åç§°';
comment on column address is '@cname:åœ°å€';
comment on column city_code is '@cname:åŸå¸‚ç¼–ç ';
comment on column phone is '@cname:ç”µè¯';
comment on column lat is '@cname:çº¬åº¦';
comment on column lon is '@cname:ç»åº¦';
comment on column create_time is '@cname:åˆ›å»ºæ—¶é—´';

# æ·»åŠ geoç‚¹
alter table t_dealer
add pnt POINT NULL comment 'ç»çº¬åº¦çš„geoç‚¹';
# ä»ç»çº¬åº¦ä¸­è¡¥å…¨æ•°æ®
update t_dealer set pnt = point(lat,lon);
# æ”¹ä¸ºnot nullä¹‹åæ‰èƒ½æ·»åŠ ç´¢å¼•
alter table t_dealer MODIFY pnt POINT not null;
# æ·»åŠ ç´¢å¼•ï¼Œè¿™ç§ç´¢å¼•è¦æ±‚å­—æ®µnot null
ALTER TABLE t_dealer ADD SPATIAL INDEX spatIdx(pnt);

 
# å‡ ç§ç©ºé—´å¯¹è±¡æ¯”è¾ƒæ–¹æ³• 
SET @g1 = GEOMFROMTEXT('Polygon((30.7108682140 114.0961681600,30.6890070000 114.5951950000,
30.2507470000 114.5767980000,30.2507470000 114.1030670000,30.7108682140 114.0961681600))');
SET @g2 = pointfromtext('Point(30.476421 114.403866)');
 
# æ³¨æ„ï¼šæ¯”è¾ƒçš„éƒ½æ˜¯å¤–åŒ…ç»œå‡ ä½•ç±»å‹å¯¹è±¡ 
# åŒ…å«
select * from t_dealer where MBRCONTAINS(@g1,pnt);
SELECT MBRCONTAINS(@g1,@g2), MBRCONTAINS(@g2,@g1), MBRCONTAINS(@g1,@g1);
# è¢«åŒ…å«
select * from t_dealer where MBRWITHIN(pnt,@g1);
SELECT MBRWITHIN(@g2,@g1),MBRWITHIN(@g1,@g2);
# ä¸ç›¸äº¤ 
SELECT MBRDISJOINT(@g1,@g2);
# ç›¸ç­‰ 
SELECT MBREQUAL(@g1,@g2);
# ç›¸äº¤ 
SELECT MBRINTERSECTS(@g1,@g2);
# é‡å  
SELECT MBROVERLAPS(@g1,@g2);
# ç›¸åˆ‡ 
SELECT MBRTOUCHES(@g1,@g2);
# è·ç¦» å•ä½ m
select id,dealer_name,city_code,phone,lat,lon,
  GLength(LineStringFromWKB(linestring(pnt,pointfromtext('Point(30.476421 114.403866)'))))*100*1000 as distance
from t_dealer
order by distance asc;


</code></pre>
<p><img src="https://f1.465798.xyz/img/20240105/PGgzEM.jpg" alt="ç¦»æˆ‘æœ€è¿‘æŸ¥è¯¢å®ä¾‹" /></p>
<p>æ•°æ®ä¸‹è½½:<br />
<a href="media/16661412450896/dealer_insert.zip">dealer_insert.zip</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ubuntuéƒ¨åˆ†è½¯ä»¶ä¸èƒ½ä½¿ç”¨ä¸­æ–‡è¾“å…¥æ³•]]></title>
    <link href="https://tuzhihao.com/16661412450247.html"/>
    <updated>2022-10-19T09:00:45+08:00</updated>
    <id>https://tuzhihao.com/16661412450247.html</id>
    <content type="html"><![CDATA[
<p>ubuntuå®‰è£…äº†fcitxä¹‹åï¼Œå®‰è£…äº†æœç‹—è¾“å…¥æ³•ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸èƒ½åœ¨wineä¸‹çš„QQä¸‹è¾“å…¥ä¸­æ–‡ï¼ŒåŒ…æ‹¬Intellij IDEAæœ‰æ—¶å€™ä¹Ÿä¸è¡Œã€‚<br />
çœ‹ç½‘ä¸Šçš„æ•™ç¨‹ï¼Œå¥½åƒæ˜¯å› ä¸ºæœ‰ibusçš„å­˜åœ¨ï¼Œè€Œä¸”é»˜è®¤ä¸ºibusï¼Œæ‰€ä»¥æ‰ä¸è¡Œçš„ï¼Œæœ‰ä¸€ä¸ªç®€å•çš„è§£å†³åŠæ³•ï¼Œå°±æ˜¯åœ¨è¿™äº›è½¯ä»¶çš„å¯åŠ¨è„šæœ¬å‰åŠ ä¸€è¡Œå‘½ä»¤ï¼Œå°±å¯ä»¥è§£å†³äº†ã€‚<br />
ä¾‹å¦‚ï¼š<br />
Intellij IDEAï¼Œå¯åŠ¨è„šæœ¬æ˜¯ <code>/home/methol/software/idea-IU-162.1121.32/bin/idea.sh</code>ï¼Œä½¿ç”¨vimç¼–è¾‘ï¼Œåœ¨ä¸‹é¢è¿™æ®µæ–‡å­—å‰åŠ ä¸Šè¿™æ®µè¯ã€‚</p>
<pre><code class="language-plain_text"># ---------------------------------------------------------------------
# Run the IDE.
# ---------------------------------------------------------------------
</code></pre>
<p>åŠ ä¸Šï¼š</p>
<pre><code class="language-plain_text">XMODIFIERS=&quot;@im=fcitx&quot;
export XMODIFIERS
</code></pre>
<p>å¦‚å›¾ï¼š<br />
<img src="https://f1.465798.xyz/img/20240105/dSYXPB.jpg" alt="IDEAè„šæœ¬ç¤ºä¾‹" /></p>
<p>Wine QQçš„å¯åŠ¨è„šæœ¬æ˜¯<code>/opt/longene/qq/qq.sh</code><br />
å¦‚å›¾ï¼š<br />
<img src="https://f1.465798.xyz/img/20240105/OW716w.jpg" alt="Wine QQ è„šæœ¬ç¤ºä¾‹" /></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[webä¸Šä¼ æ–‡ä»¶å¤¹]]></title>
    <link href="https://tuzhihao.com/16661412450064.html"/>
    <updated>2022-10-19T09:00:45+08:00</updated>
    <id>https://tuzhihao.com/16661412450064.html</id>
    <content type="html"><![CDATA[
<p>ä½¿ç”¨html5çš„apiæ¥ä¸Šä¼ æ–‡ä»¶å¤¹ï¼Œåªæœ‰chromeæ”¯æŒã€‚</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;input id=&quot;upload&quot; type='file' name=&quot;file&quot; webkitdirectory&gt;
&lt;button id=&quot;button&quot;&gt;æŒ‰é’®&lt;/button&gt;
&lt;/body&gt;
&lt;script src=&quot;//libs.useso.com/js/jquery/1.11.1/jquery.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  function Map() {
    /**
     * ç»“æ„
     * @param key
     * @param value
     */
    function Struct(key, value) {
      this.key = key;
      this.value = value;
    }

    /**
     * æ•°æ®å­˜æ”¾æ•°ç»„
     */
    this.arr = [];
    /**
     * å¢åŠ æ•°æ®
     * @param key {String}
     * @param value {Object}
     */
    this.put = function (key, value) {
      for (var i = 0; i &lt; this.arr.length; i++) {
        if (this.arr[i].key === key) {
          this.arr[i].value = value;
          return;
        }
      }
      this.arr[this.arr.length] = new Struct(key, value);
    };
    /**
     * é€šè¿‡keyè·å–æ•°æ®
     * @param key {String}
     * @returns {Object}
     */
    this.get = function (key) {
      for (var i = 0; i &lt; this.arr.length; i++) {
        if (this.arr[i].key === key) {
          return this.arr[i].value;
        }
      }
      return null;
    };
    /**
     * åˆ é™¤æ•°æ®
     * @param key{String}
     */
    this.remove = function (key) {
      var v;
      for (var i = 0; i &lt; this.arr.length; i++) {
        v = this.arr[i];
        if (v.key === key) {
          this.arr.splice(i, 1);
          return;
        }
      }
    };
    /**
     * æ˜¯å¦å­˜åœ¨key
     * @param key {String}
     * @returns {boolean}
     */
    this.containsKey = function (key) {
      var v;
      for (var i = 0; i &lt; this.arr.length; i++) {
        v = this.arr[i];
        if (v.key === key) {
          return true;
        }
      }
      return false;
    };
    /**
     * è·å–mapæ•°æ®é‡
     * @returns {Number}
     */
    this.size = function () {
      return this.arr.length;
    };
    /**
     * åˆ¤æ–­Mapæ˜¯å¦ä¸ºç©º
     * @returns {boolean}
     */
    this.isEmpty = function () {
      return this.arr.length &lt;= 0;
    };
    /**
     * å…¨éƒ¨æ¸…ç©º
     */
    this.removeAll = function () {
      this.arr = [];
    };
  }
&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  var host = &quot;http://example.com&quot;;  // è¿œç¨‹æœåŠ¡å™¨åœ°å€
  var map = new Map();  // ç”¨æ¥å­˜æ”¾æ–‡ä»¶å¤¹è·¯å¾„å’Œidçš„é”®å€¼å¯¹
  var files = [];

  $(&quot;#upload&quot;).change(function () {
    files = this.files;
    console.log(files);
  });

  $(&quot;#button&quot;).on(&quot;click&quot;, function () {
    for (var i = 0; i &lt; files.length; i++) {
      var file = files[i];
      console.log(file);
      var path = getFolder(file.webkitRelativePath);
      var folderId = getFolderIdFromMap(path);
      // åˆ›å»ºæ–‡ä»¶
      uploadResource(file, folderId, 10001);
    }
  });

  function uploadResource(file, folderId, projectId) {
    var filepath = null;
    var formData = new FormData();
    formData.append(&quot;text&quot;, file);
    $.ajax({
      url: host + &quot;/sys/upload/uploadProjectResource&quot;,
      type: &quot;POST&quot;,
      data: formData,
      xhrFields: {
        withCredentials: true // ç¡®ä¿è¯·æ±‚ä¼šæºå¸¦ä¸ŠCookie
      },
      enctype: 'multipart/form-data',
      processData: false,  // tell jQuery not to process the data
      contentType: false,
      complete: function (respResult) {
        if (respResult.status == 200) {
          filepath = respResult.responseText;
          $.ajax({
            url: host + &quot;/project/resource/create&quot;,
            type: &quot;post&quot;,
            dataType: &quot;json&quot;,
            xhrFields: {
              withCredentials: true
            },
            beforeSend: function (xhr) {
              xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application/json&quot;);
            },
            data: JSON.stringify({
              &quot;projectId&quot;: projectId,
              &quot;resourceContent&quot;: filepath,
              &quot;resourceName&quot;: file.name,
              &quot;folderId&quot;: folderId,
              &quot;type&quot;: 20  // å½“å‰æ˜¯æ–‡ä»¶èµ„æº
            }),
            success: function (data) {
              console.log(data);
            },
            error: function (respResult) {
            }
          });
        } else {
        }
      }
    });
  }

  function getFolderIdFromMap(path) {
    var folderId = map.get(path);
    var folderName = path.substring(path.lastIndexOf(&quot;/&quot;) + 1, path.length);
    var localFolder = 0;
    if (path.indexOf(&quot;/&quot;) &gt; 0) {
      // è¯´æ˜å½“å‰ä¸æ˜¯æœ€é«˜çº§ç›®å½•ï¼Œæ˜¯å­ç›®å½•
      localFolder = getFolderIdFromMap(path.substring(0, path.lastIndexOf(&quot;/&quot;)));
    }
    if (folderId == null) {
      $.ajax({
        async: false,
        url: host + &quot;/project/resource/create/folder&quot;,
        type: &quot;post&quot;,
        dataType: &quot;json&quot;,
        xhrFields: {
          withCredentials: true
        },
        beforeSend: function (xhr) {
          xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application/json&quot;);
        },
        data: JSON.stringify({
          &quot;projectId&quot;: 10001,
          &quot;folderName&quot;: folderName,
          &quot;folderId&quot;: localFolder
        }),
        success: function (data) {
          console.log(data);
          folderId = data.id;
          map.put(path, folderId);
        },
        error: function (respResult) {
        }
      });
    }
    return folderId;
  }

  function getFolder(path) {
    console.log(path);
    var index = path.lastIndexOf(&quot;/&quot;);
    return path.substring(0, index);
  }
&lt;/script&gt;

&lt;/html&gt;
</code></pre>
<p>æœåŠ¡å™¨é‡‡ç”¨javaï¼Œç”¨äº†æ¥å—æ–‡ä»¶å’Œåˆ›å»ºæ–‡ä»¶å¤¹ã€‚<br />
æ–‡ä»¶å¤¹ä¹Ÿæ˜¯è™šæ‹Ÿçš„ï¼Œé‡‡ç”¨åœ¨å½“å‰è®°å½•å¢åŠ parentIdæ¥å­˜å‚¨çˆ¶èŠ‚ç‚¹ï¼Œå®ç°æ ‘çš„ç»“æ„ã€‚<br />
è¡¨ç»“æ„ï¼š</p>
<pre><code class="language-sql">CREATE TABLE t_project_resource_folder
(
    id BIGINT(20) PRIMARY KEY NOT NULL COMMENT 'ä¸»é”®',
    folder_name VARCHAR(255) DEFAULT '' COMMENT 'æ–‡ä»¶å¤¹å',
    parent_id BIGINT(20) DEFAULT '0' NOT NULL COMMENT 'çˆ¶æ–‡ä»¶å¤¹id,0è¡¨ç¤ºé¡¶çº§ç›®å½•'
)
CREATE TABLE t_project_resource
(
    id BIGINT(20) PRIMARY KEY NOT NULL COMMENT 'ä¸»é”®',
    resource_name VARCHAR(255) NOT NULL COMMENT 'èµ„æºå',
    resource_content VARCHAR(255) COMMENT 'èµ„æºå†…å®¹,é€šå¸¸æ˜¯æ”¾åœ¨ossæ–‡ä»¶çš„url',
    resource_folder_id BIGINT(20) DEFAULT '0' COMMENT 'èµ„æºæ–‡ä»¶å¤¹ID,0è¡¨ç¤ºæ–‡ä»¶å¤„äºé¡¶çº§ç›®å½•'
)
</code></pre>
<p>æœåŠ¡å™¨ç«¯æ¥å£çš„ä»£ç ï¼š</p>
<pre><code class="language-java">@RequestMapping(value = &quot;&quot;, method = RequestMethod.POST)
public ResponseEntity&lt;String&gt; upload(MultipartFile text) throws Exception {
  String fileName = text.getOriginalFilename();
  int lastDot = fileName.lastIndexOf(&quot;.&quot;);
  String type = fileName.substring(lastDot + 1);
  String sb = &quot;uploads&quot; + &quot;/&quot; + UUID.randomUUID().toString() + &quot;.&quot; + type;
  String uploadPath = storageProvider.upload(sb, text);  // è°ƒç”¨serviceæ¥å£æŠŠæ–‡ä»¶å­˜åˆ°ossä¸­ï¼Œè¿”å›æ–‡ä»¶åœ¨ossçš„åœ°å€
  return ResponseEntity.ok(uploadPath);
}
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[shadowsocksç”¨æˆ·è¿æ¥æ•°æŸ¥çœ‹è„šæœ¬]]></title>
    <link href="https://tuzhihao.com/16661412450464.html"/>
    <updated>2022-10-19T09:00:45+08:00</updated>
    <id>https://tuzhihao.com/16661412450464.html</id>
    <content type="html"><![CDATA[
<pre><code class="language-shell">#!/bin/bash
cd ~
echo  &gt;shadowsocks_clients.txt
for ((i=9101; i&lt;9105; i++)); do
echo ${i}: &gt;&gt;shadowsocks_clients.txt
lsof -i -n -P | egrep -c &quot;:${i}.+ESTABLISHED&quot;  &gt;&gt;shadowsocks_clients.txt
lsof -i -n -P | egrep &quot;:${i}.+ESTABLISHED&quot;  &gt;&gt;shadowsocks_clients.txt
echo  &gt;&gt;shadowsocks_clients.txt
echo  &gt;&gt;shadowsocks_clients.txt
done

cat shadowsocks_clients.txt
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å•ä¾‹æ¨¡å¼]]></title>
    <link href="https://tuzhihao.com/16661412449730.html"/>
    <updated>2022-10-19T09:00:44+08:00</updated>
    <id>https://tuzhihao.com/16661412449730.html</id>
    <content type="html"><![CDATA[
<h3><a id="%E6%87%92%E6%B1%89%E5%BC%8F%EF%BC%8C%E7%BA%BF%E7%A8%8B%E4%B8%8D%E5%AE%89%E5%85%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a><del>æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨</del></h3>
<p>å½“è¢«é—®åˆ°è¦å®ç°ä¸€ä¸ªå•ä¾‹æ¨¡å¼æ—¶ï¼Œå¾ˆå¤šäººçš„ç¬¬ä¸€ååº”æ˜¯å†™å‡ºå¦‚ä¸‹çš„ä»£ç ï¼ŒåŒ…æ‹¬æ•™ç§‘ä¹¦ä¸Šä¹Ÿæ˜¯è¿™æ ·æ•™æˆ‘ä»¬çš„ã€‚</p>
<pre><code class="language-java">public class Singleton {
    private static Singleton instance;
    private Singleton (){}

    public static Singleton getInstance() {
     if (instance == null) {
         instance = new Singleton();
     }
     return instance;
    }
}
</code></pre>
<p>è¿™æ®µä»£ç ç®€å•æ˜äº†ï¼Œè€Œä¸”ä½¿ç”¨äº†æ‡’åŠ è½½æ¨¡å¼ï¼Œä½†æ˜¯å´å­˜åœ¨è‡´å‘½çš„é—®é¢˜ã€‚å½“æœ‰å¤šä¸ªçº¿ç¨‹å¹¶è¡Œè°ƒç”¨ getInstance() çš„æ—¶å€™ï¼Œå°±ä¼šåˆ›å»ºå¤šä¸ªå®ä¾‹ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨å¤šçº¿ç¨‹ä¸‹ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚</p>
<h3><a id="%E6%87%92%E6%B1%89%E5%BC%8F%EF%BC%8C%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨</h3>
<p>ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯å°†æ•´ä¸ª getInstance() æ–¹æ³•è®¾ä¸ºåŒæ­¥ï¼ˆ==synchronized==ï¼‰ã€‚</p>
<pre><code class="language-java">public static synchronized Singleton getInstance() {
    if (instance == null) {
        instance = new Singleton();
    }
    return instance;
}
</code></pre>
<p>è™½ç„¶åšåˆ°äº†çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸”è§£å†³äº†å¤šå®ä¾‹çš„é—®é¢˜ï¼Œä½†æ˜¯å®ƒå¹¶ä¸é«˜æ•ˆã€‚å› ä¸ºåœ¨ä»»ä½•æ—¶å€™åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ getInstance() æ–¹æ³•ã€‚ä½†æ˜¯åŒæ­¥æ“ä½œåªéœ€è¦åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ‰è¢«éœ€è¦ï¼Œå³ç¬¬ä¸€æ¬¡åˆ›å»ºå•ä¾‹å®ä¾‹å¯¹è±¡æ—¶ã€‚è¿™å°±å¼•å‡ºäº†åŒé‡æ£€éªŒé”ã€‚</p>
<h3><a id="%E5%8F%8C%E9%87%8D%E6%A3%80%E9%AA%8C%E9%94%81" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>åŒé‡æ£€éªŒé”</h3>
<p>åŒé‡æ£€éªŒé”æ¨¡å¼ï¼ˆdouble checked locking patternï¼‰ï¼Œæ˜¯ä¸€ç§ä½¿ç”¨åŒæ­¥å—åŠ é”çš„æ–¹æ³•ã€‚ç¨‹åºå‘˜ç§°å…¶ä¸ºåŒé‡æ£€æŸ¥é”ï¼Œå› ä¸ºä¼šæœ‰ä¸¤æ¬¡æ£€æŸ¥<code>instance == null</code>ï¼Œä¸€æ¬¡æ˜¯åœ¨åŒæ­¥å—å¤–ï¼Œä¸€æ¬¡æ˜¯åœ¨åŒæ­¥å—å†…ã€‚ä¸ºä»€ä¹ˆåœ¨åŒæ­¥å—å†…è¿˜è¦å†æ£€éªŒä¸€æ¬¡ï¼Ÿå› ä¸ºå¯èƒ½ä¼šæœ‰å¤šä¸ªçº¿ç¨‹ä¸€èµ·è¿›å…¥åŒæ­¥å—å¤–çš„ ifï¼Œå¦‚æœåœ¨åŒæ­¥å—å†…ä¸è¿›è¡ŒäºŒæ¬¡æ£€éªŒçš„è¯å°±ä¼šç”Ÿæˆå¤šä¸ªå®ä¾‹äº†ã€‚</p>
<pre><code class="language-java">public static Singleton getSingleton() {
    if (instance == null) {   //Single Checked
        synchronized (Singleton.class) {
            if (instance == null) {   //Double Checked
                instance = new Singleton();
            }
        }
    }
    return instance ;
}
</code></pre>
<p>è¿™æ®µä»£ç çœ‹èµ·æ¥å¾ˆå®Œç¾ï¼Œå¾ˆå¯æƒœï¼Œå®ƒæ˜¯æœ‰é—®é¢˜ã€‚ä¸»è¦åœ¨äº<code>instance = new Singleton()</code>è¿™å¥ï¼Œè¿™å¹¶éæ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼Œäº‹å®ä¸Šåœ¨ JVM ä¸­è¿™å¥è¯å¤§æ¦‚åšäº†ä¸‹é¢ 3 ä»¶äº‹æƒ…ã€‚</p>
<ul>
<li>1.ç»™ instance åˆ†é…å†…å­˜</li>
<li>2.è°ƒç”¨ Singleton çš„æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–æˆå‘˜å˜é‡</li>
<li>3.å°†instanceå¯¹è±¡æŒ‡å‘åˆ†é…çš„å†…å­˜ç©ºé—´ï¼ˆæ‰§è¡Œå®Œè¿™æ­¥ instance å°±ä¸ºé null äº†ï¼‰</li>
</ul>
<p>ä½†æ˜¯åœ¨ JVM çš„å³æ—¶ç¼–è¯‘å™¨ä¸­å­˜åœ¨æŒ‡ä»¤é‡æ’åºçš„ä¼˜åŒ–ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸Šé¢çš„ç¬¬äºŒæ­¥å’Œç¬¬ä¸‰æ­¥çš„é¡ºåºæ˜¯ä¸èƒ½ä¿è¯çš„ï¼Œæœ€ç»ˆçš„æ‰§è¡Œé¡ºåºå¯èƒ½æ˜¯ 1-2-3 ä¹Ÿå¯èƒ½æ˜¯ 1-3-2ã€‚å¦‚æœæ˜¯åè€…ï¼Œåˆ™åœ¨ 3 æ‰§è¡Œå®Œæ¯•ã€2 æœªæ‰§è¡Œä¹‹å‰ï¼Œè¢«çº¿ç¨‹äºŒæŠ¢å äº†ï¼Œè¿™æ—¶ instance å·²ç»æ˜¯é null äº†ï¼ˆä½†å´æ²¡æœ‰åˆå§‹åŒ–ï¼‰ï¼Œæ‰€ä»¥çº¿ç¨‹äºŒä¼šç›´æ¥è¿”å› instanceï¼Œç„¶åä½¿ç”¨ï¼Œç„¶åé¡ºç†æˆç« åœ°æŠ¥é”™ã€‚</p>
<p>æˆ‘ä»¬åªéœ€è¦å°† instance å˜é‡å£°æ˜æˆ volatile å°±å¯ä»¥äº†ã€‚</p>
<pre><code class="language-java">public class Singleton {
    private volatile static Singleton instance; //å£°æ˜æˆ volatile
    private Singleton (){}

    public static Singleton getSingleton() {
        if (instance == null) {                         
            synchronized (Singleton.class) {
                if (instance == null) {       
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }

}
</code></pre>
<p>æœ‰äº›äººè®¤ä¸ºä½¿ç”¨ volatile çš„åŸå› æ˜¯å¯è§æ€§ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ä¿è¯çº¿ç¨‹åœ¨æœ¬åœ°ä¸ä¼šå­˜æœ‰ instance çš„å‰¯æœ¬ï¼Œæ¯æ¬¡éƒ½æ˜¯å»ä¸»å†…å­˜ä¸­è¯»å–ã€‚ä½†å…¶å®æ˜¯ä¸å¯¹çš„ã€‚ä½¿ç”¨ volatile çš„ä¸»è¦åŸå› æ˜¯å…¶å¦ä¸€ä¸ªç‰¹æ€§ï¼šç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ volatile å˜é‡çš„èµ‹å€¼æ“ä½œåé¢ä¼šæœ‰ä¸€ä¸ªå†…å­˜å±éšœï¼ˆç”Ÿæˆçš„æ±‡ç¼–ä»£ç ä¸Šï¼‰ï¼Œè¯»æ“ä½œä¸ä¼šè¢«é‡æ’åºåˆ°å†…å­˜å±éšœä¹‹å‰ã€‚æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œå–æ“ä½œå¿…é¡»åœ¨æ‰§è¡Œå®Œ 1-2-3 ä¹‹åæˆ–è€… 1-3-2 ä¹‹åï¼Œä¸å­˜åœ¨æ‰§è¡Œåˆ° 1-3 ç„¶åå–åˆ°å€¼çš„æƒ…å†µã€‚ä»ã€Œå…ˆè¡Œå‘ç”ŸåŸåˆ™ã€çš„è§’åº¦ç†è§£çš„è¯ï¼Œå°±æ˜¯å¯¹äºä¸€ä¸ª volatile å˜é‡çš„å†™æ“ä½œéƒ½å…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œï¼ˆè¿™é‡Œçš„â€œåé¢â€æ˜¯æ—¶é—´ä¸Šçš„å…ˆåé¡ºåºï¼‰ã€‚</p>
<p>ä½†æ˜¯ç‰¹åˆ«æ³¨æ„åœ¨ Java 5 ä»¥å‰çš„ç‰ˆæœ¬ä½¿ç”¨äº† volatile çš„åŒæ£€é”è¿˜æ˜¯æœ‰é—®é¢˜çš„ã€‚å…¶åŸå› æ˜¯ Java 5 ä»¥å‰çš„ JMM ï¼ˆJava å†…å­˜æ¨¡å‹ï¼‰æ˜¯å­˜åœ¨ç¼ºé™·çš„ï¼Œå³æ—¶å°†å˜é‡å£°æ˜æˆ volatile ä¹Ÿä¸èƒ½å®Œå…¨é¿å…é‡æ’åºï¼Œä¸»è¦æ˜¯ volatile å˜é‡å‰åçš„ä»£ç ä»ç„¶å­˜åœ¨é‡æ’åºé—®é¢˜ã€‚è¿™ä¸ª volatile å±è”½é‡æ’åºçš„é—®é¢˜åœ¨ Java 5 ä¸­æ‰å¾—ä»¥ä¿®å¤ï¼Œæ‰€ä»¥åœ¨è¿™ä¹‹åæ‰å¯ä»¥æ”¾å¿ƒä½¿ç”¨ volatileã€‚</p>
<p>ç›¸ä¿¡ä½ ä¸ä¼šå–œæ¬¢è¿™ç§å¤æ‚åˆéšå«é—®é¢˜çš„æ–¹å¼ï¼Œå½“ç„¶æˆ‘ä»¬æœ‰æ›´å¥½çš„å®ç°çº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼çš„åŠæ³•ã€‚</p>
<h3><a id="%E9%A5%BF%E6%B1%89%E5%BC%8Fstatic-final-field" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>é¥¿æ±‰å¼ static final field</h3>
<p>è¿™ç§æ–¹æ³•éå¸¸ç®€å•ï¼Œå› ä¸ºå•ä¾‹çš„å®ä¾‹è¢«å£°æ˜æˆ static å’Œ final å˜é‡äº†ï¼Œåœ¨ç¬¬ä¸€æ¬¡åŠ è½½ç±»åˆ°å†…å­˜ä¸­æ—¶å°±ä¼šåˆå§‹åŒ–ï¼Œæ‰€ä»¥åˆ›å»ºå®ä¾‹æœ¬èº«æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
<pre><code class="language-java">public class Singleton {  
    private static class SingletonHolder {  
        private static final Singleton INSTANCE = new Singleton();  
    }  
    private Singleton (){}  
    public static final Singleton getInstance() {  
        return SingletonHolder.INSTANCE;
    }  
}
</code></pre>
<p>è¿™ç§å†™æ³•ä»ç„¶ä½¿ç”¨JVMæœ¬èº«æœºåˆ¶ä¿è¯äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼›ç”±äº SingletonHolder æ˜¯ç§æœ‰çš„ï¼Œé™¤äº† getInstance() ä¹‹å¤–æ²¡æœ‰åŠæ³•è®¿é—®å®ƒï¼Œå› æ­¤å®ƒæ˜¯æ‡’æ±‰å¼çš„ï¼›åŒæ—¶è¯»å–å®ä¾‹çš„æ—¶å€™ä¸ä¼šè¿›è¡ŒåŒæ­¥ï¼Œæ²¡æœ‰æ€§èƒ½ç¼ºé™·ï¼›ä¹Ÿä¸ä¾èµ– JDK ç‰ˆæœ¬ã€‚</p>
<h3><a id="%E6%9E%9A%E4%B8%BEenum" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æšä¸¾ Enum</h3>
<p>ç”¨æšä¸¾å†™å•ä¾‹å®åœ¨å¤ªç®€å•äº†ï¼è¿™ä¹Ÿæ˜¯å®ƒæœ€å¤§çš„ä¼˜ç‚¹ã€‚ä¸‹é¢è¿™æ®µä»£ç å°±æ˜¯å£°æ˜æšä¸¾å®ä¾‹çš„é€šå¸¸åšæ³•ã€‚</p>
<pre><code class="language-java">public enum EasySingleton{
    INSTANCE;
}
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡EasySingleton.INSTANCEæ¥è®¿é—®å®ä¾‹ï¼Œè¿™æ¯”è°ƒç”¨getInstance()æ–¹æ³•ç®€å•å¤šäº†ã€‚åˆ›å»ºæšä¸¾é»˜è®¤å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦æ‹…å¿ƒdouble checked lockingï¼Œè€Œä¸”è¿˜èƒ½é˜²æ­¢ååºåˆ—åŒ–å¯¼è‡´é‡æ–°åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ä½†æ˜¯è¿˜æ˜¯å¾ˆå°‘çœ‹åˆ°æœ‰äººè¿™æ ·å†™ï¼Œå¯èƒ½æ˜¯å› ä¸ºä¸å¤ªç†Ÿæ‚‰å§ã€‚</p>
<h3><a id="%E6%80%BB%E7%BB%93" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>æ€»ç»“</h3>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œå•ä¾‹æ¨¡å¼æœ‰äº”ç§å†™æ³•ï¼šæ‡’æ±‰ã€é¥¿æ±‰ã€åŒé‡æ£€éªŒé”ã€é™æ€å†…éƒ¨ç±»ã€æšä¸¾ã€‚ä¸Šè¿°æ‰€è¯´éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„å®ç°ï¼Œæ–‡ç« å¼€å¤´ç»™å‡ºçš„ç¬¬ä¸€ç§æ–¹æ³•ä¸ç®—æ­£ç¡®çš„å†™æ³•ã€‚<br />
å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç›´æ¥ä½¿ç”¨==<strong>é¥¿æ±‰å¼</strong>==å°±å¥½äº†ï¼Œå¦‚æœæ˜ç¡®è¦æ±‚è¦æ‡’åŠ è½½ï¼ˆlazy initializationï¼‰ä¼šå€¾å‘äºä½¿ç”¨==<strong>é™æ€å†…éƒ¨ç±»</strong>==ï¼Œå¦‚æœæ¶‰åŠåˆ°ååºåˆ—åŒ–åˆ›å»ºå¯¹è±¡æ—¶ä¼šè¯•ç€ä½¿ç”¨==<strong>æšä¸¾</strong>==çš„æ–¹å¼æ¥å®ç°å•ä¾‹ã€‚</p>
<h3><a id="read-more" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Read More</h3>
<blockquote>
<ul>
<li><a href="http://javarevisited.blogspot.sg/2014/05/double-checked-locking-on-singleton-in-java.html">Double Checked Locking on Singleton Class in Java</a></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><a href="http://javarevisited.blogspot.sg/2012/07/why-enum-singleton-are-better-in-java.html">Why Enum Singleton are better in Java</a></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><a href="http://javarevisited.blogspot.com/2012/12/how-to-create-thread-safe-singleton-in-java-example.html">How to create thread safe Singleton in Java</a></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><a href="http://javarevisited.blogspot.com/2011/03/10-interview-questions-on-singleton.html">10 Singleton Pattern Interview questions in Java</a></li>
</ul>
</blockquote>
<p>è½¬è½½ï¼š</p>
<blockquote>
<p><a href="http://wuchong.me/blog/2014/08/28/how-to-correctly-write-singleton-pattern/">å¦‚ä½•æ­£ç¡®åœ°å†™å‡ºå•ä¾‹æ¨¡å¼ | Jark's Blog</a></p>
</blockquote>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[k-meansèšç±»ç®—æ³•]]></title>
    <link href="https://tuzhihao.com/16661412450535.html"/>
    <updated>2022-10-19T09:00:45+08:00</updated>
    <id>https://tuzhihao.com/16661412450535.html</id>
    <content type="html"><![CDATA[
<p>èšç±»åˆ†æç®—æ³•çš„ä¸€ä¸ªjavaä»£ç ï¼Œæˆ‘çš„é¡¹ç›®ä¸­åº”ç”¨äº†è¿™ä¸ªä»£ç ã€‚</p>
<pre><code class="language-java">package com.methol.util;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;

//K-meansç®—æ³•å®ç°

public class KMeans {
    // èšç±»çš„æ•°ç›®
    public final static int ClassCount = 4;
    // æ ·æœ¬æ•°ç›®ï¼ˆæµ‹è¯•é›†ï¼‰
    public static int InstanceNumber = 100;
    // æ ·æœ¬å±æ€§æ•°ç›®ï¼ˆæµ‹è¯•ï¼‰
    public final static int FieldCount = 1;

    // è®¾ç½®å¼‚å¸¸ç‚¹é˜ˆå€¼å‚æ•°ï¼ˆæ¯ä¸€ç±»åˆå§‹çš„æœ€å°æ•°ç›®ä¸ºInstanceNumber/ClassCount^tï¼‰
    public final static double t = 2.0;
    // å­˜æ”¾æ•°æ®çš„çŸ©é˜µ
    public static double[][] data;

    // æ¯ä¸ªç±»çš„å‡å€¼ä¸­å¿ƒ
    public static double[][] classData;

    // å™ªå£°é›†åˆç´¢å¼•
    public static ArrayList&lt;Integer&gt; noises;

    // å­˜æ”¾æ¯æ¬¡å˜æ¢ç»“æœçš„çŸ©é˜µ
    public static ArrayList&lt;ArrayList&lt;Integer&gt;&gt; result;

    //å­˜æ”¾æ¯ä¸ªå±æ€§çš„æœ€å¤§å€¼
    public static double[] classmax = new double[FieldCount];

    // æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–
    public KMeans() {
        // æœ€åä¸€ä½ç”¨æ¥å‚¨å­˜ç»“æœ
        data = new double[InstanceNumber][FieldCount + 1];
        classData = new double[ClassCount][FieldCount];
        result = new ArrayList&lt;ArrayList&lt;Integer&gt;&gt;(ClassCount);
        noises = new ArrayList&lt;Integer&gt;();
    }

    /**
     * ä¸»å‡½æ•°å…¥å£ æµ‹è¯•é›†çš„æ–‡ä»¶åç§°ä¸ºâ€œæµ‹è¯•é›†.dataâ€,å…¶ä¸­æœ‰1000*57å¤§å°çš„æ•°æ® æ¯ä¸€è¡Œä¸ºä¸€ä¸ªæ ·æœ¬ï¼Œæœ‰57ä¸ªå±æ€§ ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ 1.è¯»å–æ•°æ®
     * 2.è¿›è¡Œèšç±» æœ€åç»Ÿè®¡è¿è¡Œæ—¶é—´å’Œæ¶ˆè€—çš„å†…å­˜
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub
        long startTime = System.currentTimeMillis();
        KMeans cluster = new KMeans();
        cluster.InstanceNumber = 100;
        // è¯»å–æ•°æ®
        //cluster.readData(&quot;D:/test.txt&quot;);

        //éšæœºäº§ç”Ÿæ•°æ®
        for (int i = 0; i &lt; InstanceNumber; i++) {
            data[i][0] = (double) Math.random();
            data[i][0] = data[i][0] * 100;
            System.out.println(data[i][0]);
        }

        // èšç±»è¿‡ç¨‹
        cluster.cluster();
        // è¾“å‡ºç»“æœ
        cluster.printResult(&quot;clusterResult.data&quot;);
        long endTime = System.currentTimeMillis();
        System.out.println(&quot;Total Time:&quot; + (endTime - startTime) + &quot;ms&quot;);
        System.out.println(&quot;Memory Consuming:&quot;
                + (double) (Runtime.getRuntime().totalMemory() - Runtime
                .getRuntime().freeMemory()) / 1000000 + &quot;MB&quot;);

        System.out.println(&quot;èšç±»ä¸­å¿ƒï¼š&quot;);
        for (int i = 0; i &lt; ClassCount; i++) {
            System.out.println(classData[i][0] * classmax[0]);

            //data[i][0] = (double) (Math.random()*100);
        }

        for (ArrayList&lt;Integer&gt; i : result) {
            for (Integer integer : i) {
                System.out.print(integer + &quot;\t&quot;);
            }
            System.out.println(&quot;æ•°ç›®:&quot; + i.size());
        }

        for (ArrayList&lt;Integer&gt; i : result) {
            for (Integer integer : i) {
                System.out.print(data[integer][0] + &quot;\t&quot;);
            }
            System.out.println(&quot;æ•°ç›®:&quot; + i.size());
        }

        System.out.println(&quot;noises:&quot;);
        for (Integer noise : noises) {
            System.out.println(noise);
        }
    }

    /**
     * è¯»å–æµ‹è¯•é›†çš„æ•°æ®
     *
     * @param trainingFileName æµ‹è¯•é›†æ–‡ä»¶å
     */
    public void readData(String trainingFileName) {
        try {
            FileReader fr = new FileReader(trainingFileName);
            BufferedReader br = new BufferedReader(fr);
            // å­˜æ”¾æ•°æ®çš„ä¸´æ—¶å˜é‡
            String lineData = null;
            String[] splitData = null;
            int line = 0;
            // æŒ‰è¡Œè¯»å–
            while (br.ready()) {
                // å¾—åˆ°åŸå§‹çš„å­—ç¬¦ä¸²
                lineData = br.readLine();
                splitData = lineData.split(&quot;,&quot;);
                // è½¬åŒ–ä¸ºæ•°æ®
                // System.out.println(&quot;length:&quot;+splitData.length);
                if (splitData.length &gt; 1) {
                    for (int i = 0; i &lt; splitData.length; i++) {
                        // System.out.println(splitData[i]);
                        // System.out.println(splitData[i].getClass());
                        if (splitData[i].startsWith(&quot;Iris-setosa&quot;)) {
                            data[line][i] = (double) 1.0;
                        } else if (splitData[i].startsWith(&quot;Iris-versicolor&quot;)) {
                            data[line][i] = (double) 2.0;
                        } else if (splitData[i].startsWith(&quot;Iris-virginica&quot;)) {
                            data[line][i] = (double) 3.0;
                        } else { // å°†æ•°æ®æˆªå–ä¹‹åæ”¾è¿›æ•°ç»„
                            data[line][i] = Double.parseDouble(splitData[i]);
                        }
                    }
                    line++;
                }
            }
            System.out.println(line);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    /**
     * èšç±»è¿‡ç¨‹ï¼Œä¸»è¦åˆ†ä¸ºä¸¤æ­¥ 1.å¾ªç¯æ‰¾åˆå§‹ç‚¹ 2.ä¸æ–­è°ƒæ•´ç›´åˆ°åˆ†ç±»ä¸å†å‘ç”Ÿå˜åŒ–
     */
    public void cluster() {
        // æ•°æ®æ ‡å‡†åŒ–å¤„ç†
        normalize();
        // æ ‡è®°æ˜¯å¦éœ€è¦é‡æ–°æ‰¾åˆå§‹ç‚¹
        boolean needUpdataInitials = true;

        // æ‰¾åˆå§‹ç‚¹çš„è¿­ä»£æ¬¡æ•°
        int times = 1;
        // æ‰¾åˆå§‹ç‚¹
        while (needUpdataInitials) {
            needUpdataInitials = false;
            result.clear();
            //System.out.println(&quot;Find Initials Iteration&quot; + (times++) + &quot;time(s)&quot;);

            // ä¸€æ¬¡æ‰¾åˆå§‹ç‚¹çš„å°è¯•å’Œæ ¹æ®åˆå§‹ç‚¹çš„åˆ†ç±»
            findInitials();
            firstClassify();

            // å¦‚æœæŸä¸ªåˆ†ç±»çš„æ•°ç›®å°äºç‰¹å®šçš„é˜ˆå€¼ï¼Œåˆ™è®¤ä¸ºè¿™ä¸ªåˆ†ç±»ä¸­çš„æ‰€æœ‰æ ·æœ¬éƒ½æ˜¯å™ªå£°ç‚¹
            // éœ€è¦é‡æ–°æ‰¾åˆå§‹ç‚¹
            for (int i = 0; i &lt; result.size(); i++) {
                if (result.get(i).size() &lt; InstanceNumber
                        / Math.pow(ClassCount, t)) {
                    needUpdataInitials = true;
                    noises.addAll(result.get(i));
                }
            }
        }

        // æ‰¾åˆ°åˆé€‚çš„åˆå§‹ç‚¹å
        // ä¸æ–­çš„è°ƒæ•´å‡å€¼ä¸­å¿ƒå’Œåˆ†ç±»ï¼Œç›´åˆ°ä¸å†å‘ç”Ÿä»»ä½•å˜åŒ–
        Adjust();

//        //æŠŠç»“æœå­˜å…¥æ•°ç»„answerä¸­
//        for (int i = 0; i &lt; ClassCount; i++) {
//            KMeans.answer[i] = classData[i][0];
//        }

    }

    /**
     * å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ– 1.æ‰¾æ¯ä¸€ä¸ªå±æ€§çš„æœ€å¤§å€¼ 2.å¯¹æŸä¸ªæ ·æœ¬çš„æ¯ä¸ªå±æ€§é™¤ä»¥å…¶æœ€å¤§å€¼
     */
    public void normalize() {
        // æ‰¾æœ€å¤§å€¼

        for (int i = 0; i &lt; InstanceNumber; i++) {
            for (int j = 0; j &lt; FieldCount; j++) {
                if (data[i][j] &gt; classmax[j])
                    classmax[j] = data[i][j];
            }
        }

        // å½’ä¸€åŒ–
        for (int i = 0; i &lt; InstanceNumber; i++) {
            for (int j = 0; j &lt; FieldCount; j++) {
                data[i][j] = data[i][j] / classmax[j];
            }
        }
    }

    // å…³äºåˆå§‹å‘é‡çš„ä¸€æ¬¡æ‰¾å¯»å°è¯•
    public void findInitials() {
        // a,bä¸ºæ ‡å¿—è·ç¦»æœ€è¿œçš„ä¸¤ä¸ªå‘é‡çš„ç´¢å¼•
        int i, j, a, b;
        i = j = a = b = 0;

        // æœ€è¿œè·ç¦»
        double maxDis = 0;

        // å·²ç»æ‰¾åˆ°çš„åˆå§‹ç‚¹ä¸ªæ•°
        int alreadyCls = 2;

        // å­˜æ”¾å·²ç»æ ‡è®°ä¸ºåˆå§‹ç‚¹çš„å‘é‡ç´¢å¼•
        ArrayList&lt;Integer&gt; initials = new ArrayList&lt;Integer&gt;();

        // ä»ä¸¤ä¸ªå¼€å§‹
        for (; i &lt; InstanceNumber; i++) {
            // å™ªå£°ç‚¹
            if (noises.contains(i))
                continue;
            // long startTime = System.currentTimeMillis();
            j = i + 1;
            for (; j &lt; InstanceNumber; j++) {
                // å™ªå£°ç‚¹
                if (noises.contains(j))
                    continue;
                // æ‰¾å‡ºæœ€å¤§çš„è·ç¦»å¹¶è®°å½•ä¸‹æ¥
                double newDis = calDis(data[i], data[j]);
                if (maxDis &lt; newDis) {
                    a = i;
                    b = j;
                    maxDis = newDis;
                }
            }
            // long endTime = System.currentTimeMillis();
            // System.out.println(i +
            // &quot;Vector Caculation Time:&quot;+(endTime-startTime)+&quot;ms&quot;);
        }

        // å°†å‰ä¸¤ä¸ªåˆå§‹ç‚¹è®°å½•ä¸‹æ¥
        initials.add(a);
        initials.add(b);
        classData[0] = data[a];
        classData[1] = data[b];

        // åœ¨ç»“æœä¸­æ–°å»ºå­˜æ”¾æŸæ ·æœ¬ç´¢å¼•çš„å¯¹è±¡ï¼Œå¹¶æŠŠåˆå§‹ç‚¹æ·»åŠ è¿›å»
        ArrayList&lt;Integer&gt; resultOne = new ArrayList&lt;Integer&gt;();
        ArrayList&lt;Integer&gt; resultTwo = new ArrayList&lt;Integer&gt;();
        resultOne.add(a);
        resultTwo.add(b);
        result.add(resultOne);
        result.add(resultTwo);

        // æ‰¾åˆ°å‰©ä½™çš„å‡ ä¸ªåˆå§‹ç‚¹
        while (alreadyCls &lt; ClassCount) {
            i = j = 0;
            double maxMin = 0;
            int newClass = -1;

            // æ‰¾æœ€å°å€¼ä¸­çš„æœ€å¤§å€¼
            for (; i &lt; InstanceNumber; i++) {
                double min = 0;
                double newMin = 0;
                // æ‰¾å’Œå·²æœ‰ç±»çš„æœ€å°å€¼
                if (initials.contains(i))
                    continue;
                // å™ªå£°ç‚¹å»é™¤
                if (noises.contains(i))
                    continue;
                for (j = 0; j &lt; alreadyCls; j++) {
                    newMin = calDis(data[i], classData[j]);
                    if (min == 0 || newMin &lt; min)
                        min = newMin;
                }

                // æ–°æœ€å°è·ç¦»è¾ƒå¤§
                if (min &gt; maxMin) {
                    maxMin = min;
                    newClass = i;
                }
            }
            // æ·»åŠ åˆ°å‡å€¼é›†åˆå’Œç»“æœé›†åˆä¸­
            // System.out.println(&quot;NewClass&quot;+newClass);
            initials.add(newClass);
            //System.err.println(&quot;newClass:&quot;+newClass);
            //System.err.println(&quot;alreadyCls:&quot;+alreadyCls);
            classData[alreadyCls++] = data[newClass];
            ArrayList&lt;Integer&gt; rslt = new ArrayList&lt;Integer&gt;();
            rslt.add(newClass);
            result.add(rslt);
        }
    }

    // ç¬¬ä¸€æ¬¡åˆ†ç±»
    public void firstClassify() {
        // æ ¹æ®åˆå§‹å‘é‡åˆ†ç±»
        for (int i = 0; i &lt; InstanceNumber; i++) {
            double min = 0f;
            int clsId = -1;
            for (int j = 0; j &lt; classData.length; j++) {
                // æ¬§å¼è·ç¦»
                double newMin = calDis(classData[j], data[i]);
                if (clsId == -1 || newMin &lt; min) {
                    clsId = j;
                    min = newMin;
                }

            }
            // æœ¬èº«ä¸å†æ·»åŠ 
            if (!result.get(clsId).contains(i))
                result.get(clsId).add(i);
        }
    }

    // è¿­ä»£åˆ†ç±»ï¼Œç›´åˆ°å„ä¸ªç±»çš„æ•°æ®ä¸å†å˜åŒ–
    public void Adjust() {
        // è®°å½•æ˜¯å¦å‘ç”Ÿå˜åŒ–
        boolean change = true;

        // å¾ªç¯çš„æ¬¡æ•°
        int times = 1;
        while (change) {
            // å¤ä½
            change = false;
            //System.out.println(&quot;Adjust Iteration&quot; + (times++) + &quot;time(s)&quot;);

            // é‡æ–°è®¡ç®—æ¯ä¸ªç±»çš„å‡å€¼
            for (int i = 0; i &lt; ClassCount; i++) {
                // åŸæœ‰çš„æ•°æ®
                ArrayList&lt;Integer&gt; cls = result.get(i);

                // æ–°çš„å‡å€¼
                double[] newMean = new double[FieldCount];

                // è®¡ç®—å‡å€¼
                for (Integer index : cls) {
                    for (int j = 0; j &lt; FieldCount; j++)
                        newMean[j] += data[index][j];
                }
                for (int j = 0; j &lt; FieldCount; j++)
                    newMean[j] /= cls.size();
                if (!compareMean(newMean, classData[i])) {
                    classData[i] = newMean;
                    change = true;
                }
            }
            // æ¸…ç©ºä¹‹å‰çš„æ•°æ®
            for (ArrayList&lt;Integer&gt; cls : result)
                cls.clear();

            // é‡æ–°åˆ†é…
            for (int i = 0; i &lt; InstanceNumber; i++) {
                double min = 0f;
                int clsId = -1;
                for (int j = 0; j &lt; classData.length; j++) {
                    double newMin = calDis(classData[j], data[i]);
                    if (clsId == -1 || newMin &lt; min) {
                        clsId = j;
                        min = newMin;
                    }
                }
                data[i][FieldCount] = clsId;
                result.get(clsId).add(i);
            }

            // æµ‹è¯•èšç±»æ•ˆæœ(è®­ç»ƒé›†)
            // for(int i = 0;i &lt; ClassCount;i++){
            // int positives = 0;
            // int negatives = 0;
            // ArrayList&lt;Integer&gt; cls = result.get(i);
            // for(Integer instance:cls)
            // if (data[instance][FieldCount - 1] == 1f)
            // positives ++;
            // else
            // negatives ++;
            // System.out.println(&quot; &quot; + i + &quot; Positive: &quot; + positives +
            // &quot; Negatives: &quot; + negatives);
            // }
            // System.out.println();
        }

    }

    /**
     * è®¡ç®—aæ ·æœ¬å’Œbæ ·æœ¬çš„æ¬§å¼è·ç¦»ä½œä¸ºä¸ç›¸ä¼¼åº¦
     *
     * @param aVector æ ·æœ¬a
     * @param bVector æ ·æœ¬b
     * @return æ¬§å¼è·ç¦»é•¿åº¦
     */
    private double calDis(double[] aVector, double[] bVector) {
        double dis = 0;
        int i = 0;
        /* æœ€åä¸€ä¸ªæ•°æ®åœ¨è®­ç»ƒé›†ä¸­ä¸ºç»“æœï¼Œæ‰€ä»¥ä¸è€ƒè™‘ */
        for (; i &lt; aVector.length; i++)
            dis += Math.pow(bVector[i] - aVector[i], 2);
        dis = Math.pow(dis, 0.5);
        return (double) dis;
    }

    /**
     * åˆ¤æ–­ä¸¤ä¸ªå‡å€¼å‘é‡æ˜¯å¦ç›¸ç­‰
     *
     * @param a å‘é‡a
     * @param b å‘é‡b
     * @return ç›¸ç­‰è¿”å›true
     */
    private boolean compareMean(double[] a, double[] b) {
        if (a.length != b.length)
            return false;
        for (int i = 0; i &lt; a.length; i++) {
            if (a[i] &gt; 0 &amp;&amp; b[i] &gt; 0 &amp;&amp; a[i] != b[i]) {
                return false;
            }
        }
        return true;
    }

    /**
     * å°†ç»“æœè¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­
     *
     * @param fileName æ–‡ä»¶å
     */
    public void printResult(String fileName) {
        FileWriter fw = null;
        BufferedWriter bw = null;
        try {
            fw = new FileWriter(fileName);
            bw = new BufferedWriter(fw);
            // å†™å…¥æ–‡ä»¶
            for (int i = 0; i &lt; InstanceNumber; i++) {
                bw.write(String.valueOf(data[i][FieldCount]).substring(0, 1));
                bw.newLine();
            }

            // ç»Ÿè®¡æ¯ç±»çš„æ•°ç›®ï¼Œæ‰“å°åˆ°æ§åˆ¶å°
            for (int i = 0; i &lt; ClassCount; i++) {
                System.out.println(&quot;ç¬¬&quot; + (i + 1) + &quot;ç±»æ•°ç›®: &quot;
                        + result.get(i).size());
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {

            // å…³é—­èµ„æº
            if (bw != null)
                try {
                    bw.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            if (fw != null)
                try {
                    fw.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
        }

    }
}

</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å®‰è£…pure-ftpæœåŠ¡ä»¥åŠè®¾ç½®è™šæ‹Ÿç”¨æˆ·]]></title>
    <link href="https://tuzhihao.com/16661412449667.html"/>
    <updated>2022-10-19T09:00:44+08:00</updated>
    <id>https://tuzhihao.com/16661412449667.html</id>
    <content type="html"><![CDATA[
<p>ä»Šå¤©æ‰ç®—æ˜¯ç»ˆäºæŠŠghostçš„bolgå¼„å¥½äº†ï¼Œä½†æ˜¯è¿˜æ˜¯å¾ˆéº»çƒ¦ï¼Œéƒ½æ˜¯è‡ªå·±æ­å»ºçš„ï¼Œæ²¡æœ‰å¥½çš„ç®¡ç†å¹³å°ï¼Œä¼ æ–‡ä»¶ä¹Ÿå¾ˆéº»çƒ¦ï¼Œå°±è£…äº†ä¸€ä¸ªpure-ftpï¼Œæ¥ä¸Šä¼ å’Œä¸‹è½½æ–‡ä»¶ä»€ä¹ˆçš„ã€‚</p>
<p>å‘½ä»¤ä¸å¤šï¼Œå°±ä¸‹é¢å‡ æ¡ã€‚</p>
<pre><code class="language-plain_text">#å®‰è£…pure-ftpd
apt-get install pure-ftpd
# åœ¨ç³»ç»Ÿä¸­æ·»åŠ ç›¸åº”çš„ç”¨æˆ·å’Œç»„ï¼Œå¦‚ç”¨æˆ·ftpuser å’Œç»„ftpgroup 
groupadd ftpgroup
useradd ftpuser -g ftpgroup -d /home/ftp -s /sbin/nologin 
# æ·»åŠ è™šæ‹Ÿç”¨æˆ·ï¼Œå¦‚æ·»åŠ ftpmetholï¼Œå¹¶æŒ‡å®šæŸ¥çœ‹ç›®å½•ä¸º/srv/ghost
pure-pw useradd ftpmethol -u ftpuser -g ftpgroup -d /srv/ghost
# æ ¹æ®æç¤ºè¾“å…¥ä¸¤æ¬¡å¯†ç 

# è®© pure-ftpd å»ºç«‹è™šæ‹Ÿç”¨æˆ·æ•°æ®
pure-pw mkdb

# é‡å¯æœåŠ¡
/etc/init.d/pure-ftpd restart

</code></pre>
<p>ä½†æ˜¯å¾€å¾€è¿™æ ·å¼„å®Œä¹‹åï¼Œè¿˜æ˜¯ä¸èƒ½ç™»é™†æˆåŠŸï¼Œä¼šæç¤ºç”¨æˆ·å¯†ç éªŒè¯å¤±è´¥ï¼Œè§£å†³åŠæ³•ï¼š</p>
<pre><code class="language-plain_text"># åœ¨/etc/pure-ftpd/authä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥
cd /etc/pure-ftpd/auth
ln -s /etc/pure-ftpd/conf/PureDB 60puredb
</code></pre>
<p>å…¶ä»–é‡è¦é…ç½®ï¼š</p>
<pre><code class="language-plain_text"># åŒ¿åç”¨æˆ·ç™»å½•æ”¹ä¸ºå¦
/etc/pure-ftpd/conf/NoAnonymous  å†…å®¹æ”¹ä¸ºno
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hibernateä¸­Session.loadä¸Session.getçš„åŒºåˆ«]]></title>
    <link href="https://tuzhihao.com/16661412451072.html"/>
    <updated>2022-10-19T09:00:45+08:00</updated>
    <id>https://tuzhihao.com/16661412451072.html</id>
    <content type="html"><![CDATA[
<p><code>Session.load()/get()</code>æ–¹æ³•å‡å¯ä»¥æ ¹æ®æŒ‡å®šçš„å®ä½“ç±»å’Œidä»æ•°æ®åº“è¯»å–è®°å½•ï¼Œå¹¶è¿”å›ä¸ä¹‹å¯¹åº”çš„å®ä½“å¯¹è±¡ã€‚</p>
<p>å…¶åŒºåˆ«åœ¨äºï¼š<br /><br />
å¦‚æœæœªèƒ½å‘ç°ç¬¦åˆæ¡ä»¶çš„è®°å½•ï¼Œgetæ–¹æ³•è¿”å›nullï¼Œè€Œloadæ–¹æ³•ä¼šæŠ›å‡ºä¸€ä¸ªObjectNotFoundExceptionã€‚<br />
Loadæ–¹æ³•å¯è¿”å›å®ä½“çš„ä»£ç†ç±»å®ä¾‹ï¼Œè€Œgetæ–¹æ³•æ°¸è¿œç›´æ¥è¿”å›å®ä½“ç±»ã€‚<br />
loadæ–¹æ³•å¯ä»¥å……åˆ†åˆ©ç”¨å†…éƒ¨ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ä¸­çš„ç°æœ‰æ•°æ®ï¼Œè€Œgetæ–¹æ³•åˆ™ä»…ä»…åœ¨å†…éƒ¨ç¼“å­˜ä¸­è¿›è¡Œæ•°æ®æŸ¥æ‰¾ï¼Œå¦‚æ²¡æœ‰å‘ç°å¯¹åº”æ•°æ®ï¼Œå°†è¶Šè¿‡äºŒçº§ç¼“å­˜ï¼Œç›´æ¥è°ƒç”¨SQLå®Œæˆæ•°æ®è¯»å–ã€‚</p>
<p>ä¸Šé¢æ˜¯çœ‹åˆ«äººå†™çš„ï¼Œæˆ‘è‡ªå·±è§‰å¾—<br /><br />
<strong>get()ä¸»è¦ç”¨äºæ•°æ®åº“æœ‰å¯èƒ½å­˜åœ¨ï¼Œä¹Ÿæœ‰å¯èƒ½ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œéœ€è¦ä»æ•°æ®åº“å–å‡ºæ•°æ®çš„æ—¶å€™ã€‚<br />
load()ä¸»è¦ç”¨äºå¯ä»¥è‚¯å®šæ•°æ®åº“ä¸­æœ‰è¿™ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œä»æ•°æ®åº“ä¸­å»é™¤è¿™æ¡æ•°æ®ã€‚</strong></p>
<p>ä¸‹é¢ä¸¤ä¸ªä¾‹å­ï¼Œç¬¬ä¸€ä¸ªæ˜¯é€šè¿‡è®¢å•å·å¾—åˆ°è®¢å•è¿™ä¸ªå®ä½“ç±»å¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ˜¯é€šè¿‡è®¢å•å·ï¼Œä»æ•°æ®åº“ä¸­åˆ é™¤è¿™æ¡æ•°æ®ã€‚</p>
<pre><code class="language-java">//é€šè¿‡è®¢å•å·å¾—åˆ°è®¢å•è¿™ä¸ªå®ä½“ç±»å¯¹è±¡ï¼Œä¸èƒ½è‚¯å®šè¿™ä¸ªè®¢å•æ˜¯ä¸æ˜¯åœ¨æ•°æ®åº“ä¸­å­˜åœ¨
public Order getOrder(int orderid) {
  Session session = sessionFactory.getCurrentSession();
  Order order = null;
  try {
    order = (Order) session.get(Order.class, orderid);
  } catch (RuntimeException e) {
    throw e;
  }
  return order;
}
</code></pre>
<hr />
<pre><code class="language-java">	//é€šè¿‡è®¢å•å·ï¼Œä»æ•°æ®åº“ä¸­åˆ é™¤è¿™æ¡æ•°æ®ï¼Œå¯ä»¥è‚¯å®šæ•°æ®åº“ä¸­æœ‰è¿™ä¸€æ¡æ•°æ®
	public int deleteOrder(int orderId) {
		Session session = sessionFactory.getCurrentSession();
		try {
			Order order = (Order) session.load(Order.class, orderId);
			session.delete(order);
		} catch (Exception e) {
			return -1;
		}
		return 0;
	}	
</code></pre>
<p>å‚è§<a href="http://blog.csdn.net/zhaoshl_368/article/details/6577103">http://blog.csdn.net/zhaoshl_368/article/details/6577103</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å…¨æ’åˆ—]]></title>
    <link href="https://tuzhihao.com/16661412449917.html"/>
    <updated>2022-10-19T09:00:44+08:00</updated>
    <id>https://tuzhihao.com/16661412449917.html</id>
    <content type="html"><![CDATA[
<pre><code class="language-java">/**
 * Created by Methol on 2015/4/10.
 * æ ¹æ®Aæ•°ç»„çš„å¤§å°ï¼Œè¾“å‡º 1 ~ A.length çš„å…¨æ’åˆ—
 */
public class Main {

    static int A[] = new int[5];

    /*
     æ ¹æ®Aæ•°ç»„çš„å¤§å°ï¼Œè¾“å‡º 1 ~ A.length çš„å…¨æ’åˆ—
     @param cur å½“å‰å…ƒç´ çš„ä½ç½®
     */
    public static void next_permutation(int cur) {
        if (cur == A.length) {         //é€’å½’è¾¹ç•Œ
            //åœ¨è¿™é‡Œæ‰“å°è¾“å‡ºï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¿™é‡Œå†™å…·ä½“è¦æ“ä½œçš„å‡½æ•°ï¼ŒAä¸­æœ‰æ’åˆ—å¥½çš„åºåˆ—
            for (int i = 0; i &lt; A.length; i++) {
                System.out.print(A[i] + &quot; &quot;);
            }
            System.out.println();
        } else {
            for (int i = 0; i &lt;= A.length; i++) {
                boolean ok = true;
                for (int j = 0; j &lt; cur; j++) {
                    if (A[j] == i) ok = false;         //å¦‚æœiå·²ç»åœ¨A[0]~A[cur-1]å‡ºç°è¿‡ï¼Œåˆ™ä¸èƒ½å†é€‰
                }
                if (ok) {
                    A[cur] = i;
                    next_permutation(cur + 1);    //é€’å½’è°ƒç”¨
                }
            }
        }
    }

    public static void main(String[] args) {
        next_permutation(0);
    }

}
</code></pre>
<hr />
<pre><code class="language-java">/**
 * Created by Methol on 2015/4/10.
 * è¾“å‡ºæ•°ç»„Pä¸­å…ƒç´ çš„å…¨æ’åˆ—ã€‚
 */
public class Main {
 
  static int A[] = new int[5];
  static int P[] = {1,2,3};
 
  /*
   è¾“å‡ºæ•°ç»„Pä¸­å…ƒç´ çš„å…¨æ’åˆ—ã€‚
   @param cur å½“å‰å…ƒç´ çš„ä½ç½®
   */
  public static void next_permutation(int cur) {
    if (cur == P.length) {         //é€’å½’è¾¹ç•Œ
      //åœ¨è¿™é‡Œæ‰“å°è¾“å‡ºï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¿™é‡Œå†™å…·ä½“è¦æ“ä½œçš„å‡½æ•°ï¼ŒAä¸­æœ‰æ’åˆ—å¥½çš„åºåˆ—
      for (int i = 0; i &lt; P.length; i++) {
        System.out.print(A[i] + &quot; &quot;);
      }
      System.out.println();
    } else {
      for (int i = 0; i &lt; P.length; i++) {
        if(i==0 || P[i]!=P[i-1]) {
          int c1 = 0 ,c2 = 0;
          //ç»Ÿè®¡A[0]~A[cur-1]ä¸­P[i]å‡ºç°çš„æ¬¡æ•°
          for (int j = 0; j &lt; cur ; j++)
            if(A[j] == P[i])  c1++;
          //ç»Ÿè®¡Pä¸­P[i]å‡ºç°çš„æ¬¡æ•°
          for (int j = 0; j &lt; P.length; j++)
            if( P[i] == P[j] )  c2++;
          if(c1 &lt; c2){   //å½“c1&lt;c2çš„æ—¶å€™è¯´æ˜è¿˜æœ‰å¯ä»¥é€‰çš„ï¼Œé€’å½’è°ƒç”¨
            A[cur] = P[i];
            next_permutation(cur+1);
          }
        }
      }
    }
  }
   
  public static void main(String[] args) {
    next_permutation(0);
  }
 
}
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[éå†æ‰€æœ‰01åºåˆ—]]></title>
    <link href="https://tuzhihao.com/16661412449189.html"/>
    <updated>2022-10-19T09:00:44+08:00</updated>
    <id>https://tuzhihao.com/16661412449189.html</id>
    <content type="html"><![CDATA[
<p>é€»è¾‘åˆ¤æ–­é¢˜ï¼Œæœ‰å¾ˆå¤šä¸ªæ¡ä»¶ï¼Œ1,0è¡¨ç¤ºçœŸ,å‡ï¼Œéå†æ‰€æœ‰çš„å¯èƒ½æƒ…å†µï¼Œé€’å½’æ“ä½œã€‚</p>
<pre><code class="language-java">/**
 * Created by Methol on 2015/4/8.
 */
public class Main {

  static int a[] ={0,0,0};

  public static void show(){
    for (int i = 0; i &lt; a.length; i++) {
      System.out.print(a[i]+&quot; &quot;);
    }
    System.out.println();
  }

  public  static void f(int i){

    if(i&gt;=a.length){
      //è¿™é‡Œå†™æ“ä½œ
      show();
      return;
    }

    a[i] = 0;
    f(i+1);

    a[i] = 1;
    f(i+1);

  }

  public static void main(String []args){
    f(0);
  }
}
</code></pre>
<hr />
<p>è¾“å‡ºç»“æœï¼š</p>
<p>0 0 0<br />
0 0 1<br />
0 1 0<br />
0 1 1<br />
1 0 0<br />
1 0 1<br />
1 1 0<br />
1 1 1</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[æ•°å­—ä¸‰è§’å½¢â€“åŠ¨æ€è§„åˆ’]]></title>
    <link href="https://tuzhihao.com/16661412449393.html"/>
    <updated>2022-10-19T09:00:44+08:00</updated>
    <id>https://tuzhihao.com/16661412449393.html</id>
    <content type="html"><![CDATA[
<blockquote>
<p>é¢˜ç›®</p>
</blockquote>
<p>æœ‰ä¸€ä¸ªç”±éè´Ÿæ•´æ•°ç»„æˆçš„ä¸‰è§’å½¢ï¼Œç¬¬ä¸€è¡Œåªæœ‰ä¸€ä¸ªæ•°ï¼Œé™¤äº†æœ€ä¸‹è¡Œä¹‹å¤–æ¯ä¸ªæ•°çš„å·¦ä¸‹æ–¹å’Œå³ä¸‹æ–¹å„æœ‰ä¸€ä¸ªæ•°ï¼Œå¦‚ä¸‹å›¾ï¼š<br />
<img src="https://f1.465798.xyz/img/20240105/xREB03.jpg" alt="é¢˜ç›®" /><br />
ä»ç¬¬ä¸€è¡Œå¼€å§‹ï¼Œæ¯æ¬¡å¯ä»¥å¾€åšä¸‹æˆ–å³ä¸‹èµ°ä¸€æ ¼ï¼Œç›´åˆ°èµ°åˆ°æœ€ä¸‹è¡Œï¼ŒæŠŠæ²¿é€”ç»è¿‡çš„æ•°å…¨éƒ¨åŠ èµ·æ¥ï¼Œå¦‚ä½•èµ°æ‰èƒ½ä½¿å¾—è¿™ä¸ªå’Œæœ€å¤§ã€‚</p>
<blockquote>
<p>åˆ†æ</p>
</blockquote>
<p>å¯ä»¥ä»ä¸‹å¾€ä¸Šæ¥åˆ†æ<br />
å¦‚ä¸‹:<br />
1<br />
3 2<br />
4 10 1<br />
4 3 2 20<br />
ä»ä¸‹å¼€å§‹å¾€ä¸Šæ›´æ–°ã€‚</p>
<p>ç¬¬1æ¬¡æ›´æ–°ä¸ºï¼š<br />
1<br />
3 2<br />
<strong>8 13 21</strong><br />
4 3 2 20</p>
<p>ç¬¬2æ¬¡æ›´æ–°ï¼š<br />
1<br />
<strong>16 23</strong><br />
8 13 21<br />
4 3 2 20</p>
<p>ç¬¬3æ¬¡æ›´æ–°ï¼š<br />
<strong>24</strong><br />
16 23<br />
8 13 21<br />
4 3 2 20</p>
<h2><a id="%E4%B8%89%E7%A7%8D%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95%EF%BC%9A%E9%80%92%E5%BD%92%E3%80%81%E9%80%92%E6%8E%A8%E3%80%81%E8%AE%B0%E5%BF%86%E5%8C%96%E6%90%9C%E7%B4%A2%E2%80%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ä¸‰ç§å®ç°æ–¹æ³•ï¼šé€’å½’ã€é€’æ¨ã€è®°å¿†åŒ–æœç´¢<br />
â€‹</h2>
<pre><code class="language-java">/*
é€’å½’
4
1
3 2
4 10 1
4 3 2 20
 */
import java.util.Scanner;

public class Main {

  static int [][]a = new int [100][100];   //ç”¨æ¥å­˜å‚¨æ•°å­—ä¸‰è§’å½¢çš„æ•°æ®
  static int [][]c = new int [100][100];   //ç”¨æ¥å­˜è·¯å¾„
  static int n ;
  static int count;

  public static void main(String[] args) {
    Scanner scanner = new Scanner(System.in);
    n = scanner.nextInt();
    int i,j;
    for(i=0;i&lt;n;i++){
      for(j=0;j&lt;=i;j++){
        a[i][j] = scanner.nextInt();
      }
    }

    System.out.println(fun(0, 0));
    System.out.println(&quot;è®¡ç®—äº†&quot;+count+&quot;æ¬¡&quot;);

    //è¾“å‡ºèµ°çš„è·¯å¾„
    System.out.print(&quot;è·¯å¾„å¦‚ä¸‹ï¼š(0,0)&quot;);
    int t = 0;
    for(i=1;i&lt;n;i++){
      System.out.print(&quot;-&gt;(&quot;+i+&quot;,&quot;+c[i-1][t]+&quot;)&quot;);
      t = c[i-1][t];
    }

  }

  public static int fun(int i,int j){
    if(i == n-1)
      return a[i][j];   //å¦‚æœåˆ°äº†æœ€ä¸‹é¢ä¸€å±‚ï¼Œå°±è¿”å›å½“å‰è¿™ä¸ªæ•°
    count++;

    int t1 = fun(i+1, j);
    int t2 = fun(i+1, j+1);
    if(t1&gt;t2){
      c[i][j] = j;  //è¡¨ç¤ºå½“å‰è¿™ä¸ªä½ç½®æ˜¯ä»ä¸‹ä¸€è¡Œå“ªä¸ªæ•°æ®æ¥çš„
      return a[i][j]+t1;
    }else {
      c[i][j] = j+1;  //è¡¨ç¤ºå½“å‰è¿™ä¸ªä½ç½®æ˜¯ä»ä¸‹ä¸€è¡Œå“ªä¸ªæ•°æ®æ¥çš„
      return a[i][j]+t2;
    }

    //return a[i][j] + Math.max(fun(i+1, j), fun(i+1, j+1));
  }

}
</code></pre>
<hr />
<pre><code class="language-java">/*
 * é€’æ¨
 */

import java.util.Scanner;

public class Main {

  static int [][]a = new int [4][4];
  static int [][]d = new int [4][4];
  static int n ;
  static int count;

  public static void main(String[] args) {
    Scanner scanner = new Scanner(System.in);
    n = scanner.nextInt();
    int i,j;
    for(i=0;i&lt;n;i++){
      for(j=0;j&lt;=i;j++){
        a[i][j] = scanner.nextInt();
        d[i][j] = a[i][j];
      }
    }
    for(i=n-1;i&gt;=1;i--){
      for(j=0;j&lt;i;j++){
        count++;
        d[i-1][j]+=Math.max(d[i][j], d[i][j+1]);
      }
    }
    System.out.println(d[0][0]);
    System.out.println(&quot;è®¡ç®—äº†&quot;+count+&quot;æ¬¡&quot;);

  }

}
</code></pre>
<hr />
<pre><code class="language-java">/*
 * è®°å¿†åŒ–æœç´¢
 */


import java.util.Scanner;

public class Main {
  static int [][]a = new int [100][100];
  static int [][]d = new int [100][100];
  static int n ;
  static int count;

  public static void main(String[] args) {
    Scanner scanner = new Scanner(System.in);
    n = scanner.nextInt();
    for(int i=0;i&lt;n;i++){
      for(int j=0;j&lt;=i;j++){
        a[i][j] = scanner.nextInt();
      }
    }
    System.out.println(fun(0, 0));
    System.out.println(&quot;è®¡ç®—äº†&quot;+count+&quot;æ¬¡&quot;);
  }

  public static int fun(int i,int j){
    if(i == n-1)
      return a[i][j];   //å¦‚æœåˆ°äº†æœ€ä¸‹é¢ä¸€å±‚ï¼Œå°±è¿”å›å½“å‰è¿™ä¸ªæ•°

    if(d[i][j]!=0) return d[i][j];

    count++;   //ç»Ÿè®¡ è®¡ç®—äº†å¤šå°‘æ¬¡
    d[i+1][j] = fun(i+1, j);
    d[i+1][j+1] = fun(i+1, j+1);
    return a[i][j] + Math.max(d[i+1][j], d[i+1][j+1]);
  }

}
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å…«çš‡åé—®é¢˜]]></title>
    <link href="https://tuzhihao.com/16661412449855.html"/>
    <updated>2022-10-19T09:00:44+08:00</updated>
    <id>https://tuzhihao.com/16661412449855.html</id>
    <content type="html"><![CDATA[
<pre><code class="language-c">#include &lt;iostream&gt;
#include &lt;algorithm&gt;
using namespace std;
const int size=8;
int eq[]={0,1,2,3,4,5,6,7};
long cc=0;
int eightqueen(){
  while(next_permutation(eq,eq+8)){
    bool ok=true;
    int i,j;
    //ä¸å¯èƒ½å­˜åœ¨åŒè¡ŒåŒåˆ—ï¼Œåˆ¤æ–­æ˜¯ä¸æ˜¯ç›¸åŒå¯¹è§’çº¿å°±å¯ä»¥äº†
    for(i=0;i&lt;size &amp;&amp; ok;i++){
      for(j=0;j&lt;size &amp;&amp; ok;j++){
        if(i==j) continue;
        if( (i-eq[i]==j-eq[j])||(i+eq[i]==j+eq[j]) ) //åˆ¤æ–­æ˜¯ä¸æ˜¯åœ¨åŒä¸€å¯¹è§’çº¿
          ok=false;
      }
    }
    if(ok){
      cc++;
      for(i=0;i&lt;size;i++){
        cout&lt;&lt;eq[i];
      }
      cout&lt;&lt;endl;
    }
  }
  return cc;
}
int main(){
  cout&lt;&lt;endl&lt;&lt;eightqueen()&lt;&lt;endl;
  return 0;
}
</code></pre>

]]></content>
  </entry>
  
</feed>
